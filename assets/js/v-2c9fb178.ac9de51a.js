"use strict";(self.webpackChunkmd_vuepress=self.webpackChunkmd_vuepress||[]).push([[3906],{9865:(n,s,a)=>{a.r(s),a.d(s,{data:()=>e});const e={key:"v-2c9fb178",path:"/mark/08-%E4%BB%A3%E7%A0%81%E8%A7%84%E8%8C%83.html",title:"代码规范 & Umi/ESLint 规范为什么这样设计 & 如何落地",lang:"zh-CN",frontmatter:{},excerpt:"",headers:[{level:2,title:"笔试题（6 题）",slug:"笔试题-6-题",children:[{level:3,title:"1. 代码规范的意义",slug:"_1-代码规范的意义",children:[]},{level:3,title:"2. ESLint 工作原理",slug:"_2-eslint-工作原理",children:[]},{level:3,title:"2.5. 业界标准 ESLint 配置（重点推荐）",slug:"_2-5-业界标准-eslint-配置-重点推荐",children:[]},{level:3,title:"3. Prettier vs ESLint",slug:"_3-prettier-vs-eslint",children:[]},{level:3,title:"4. Umi 规范设计",slug:"_4-umi-规范设计",children:[]},{level:3,title:"5. Git Hooks 与规范落地",slug:"_5-git-hooks-与规范落地",children:[]},{level:3,title:"6. TypeScript 类型规范",slug:"_6-typescript-类型规范",children:[]}]},{level:2,title:"面试题（4 题）",slug:"面试题-4-题",children:[{level:3,title:"1. 团队规范落地",slug:"_1-团队规范落地",children:[]},{level:3,title:"2. 规范与灵活性",slug:"_2-规范与灵活性",children:[]},{level:3,title:"3. 规范工具链建设",slug:"_3-规范工具链建设",children:[]},{level:3,title:"4. 规范实践经验",slug:"_4-规范实践经验",children:[]}]},{level:2,title:"补充：如何封装公司级 ESLint 配置",slug:"补充-如何封装公司级-eslint-配置",children:[{level:3,title:"为什么需要封装公司级配置？",slug:"为什么需要封装公司级配置",children:[]},{level:3,title:"实战：封装 @company/eslint-config",slug:"实战-封装-company-eslint-config",children:[]},{level:3,title:"收益分析",slug:"收益分析",children:[]}]}],git:{updatedTime:1770137152e3},filePathRelative:"mark/08-代码规范.md"}},5246:(n,s,a)=>{a.r(s),a.d(s,{default:()=>r});const e=(0,a(6252).uE)('<h1 id="代码规范-umi-eslint-规范为什么这样设计-如何落地" tabindex="-1"><a class="header-anchor" href="#代码规范-umi-eslint-规范为什么这样设计-如何落地" aria-hidden="true">#</a> 代码规范 &amp; Umi/ESLint 规范为什么这样设计 &amp; 如何落地</h1><h2 id="笔试题-6-题" tabindex="-1"><a class="header-anchor" href="#笔试题-6-题" aria-hidden="true">#</a> 笔试题（6 题）</h2><h3 id="_1-代码规范的意义" tabindex="-1"><a class="header-anchor" href="#_1-代码规范的意义" aria-hidden="true">#</a> 1. 代码规范的意义</h3><p>代码规范的意义是什么？包括哪些维度（格式、命名、架构、最佳实践）？如何平衡规范与效率？</p><p><strong>【作答】：</strong></p><p>代码规范意义:</p><ol><li>提升代码可读性和可维护性，降低团队协作成本</li><li>减少代码审查时的主观争议，提高开发效率</li><li>降低 Bug 率，通过静态检查发现潜在问题</li><li>形成团队知识沉淀，帮助新人快速融入</li><li>提升代码质量，建立工程化标准</li></ol><p>包括的维度:</p><ol><li><p>格式规范:</p><ul><li>缩进、空格、换行、引号使用（单引号/双引号）</li><li>最大行长度、文件末尾空行</li><li>使用 Prettier 统一格式化</li></ul></li><li><p>命名规范:</p><ul><li>变量/函数使用 camelCase（如：getUserInfo）</li><li>组件/类使用 PascalCase（如：UserProfile）</li><li>常量使用 UPPER_SNAKE_CASE（如：MAX_COUNT）</li><li>私有属性使用前缀 _（如：_privateMethod）</li><li>布尔值使用 is/has/should 前缀（如：isVisible, hasError）</li></ul></li><li><p>架构规范:</p><ul><li>目录结构约定（如：components/、utils/、hooks/）</li><li>模块职责划分（单一职责原则）</li><li>依赖关系管理（避免循环依赖）</li><li>分层架构（UI 层、逻辑层、数据层）</li></ul></li><li><p>最佳实践:</p><ul><li>React Hooks 使用规范（依赖数组、自定义 Hooks）</li><li>状态管理模式（避免过度使用全局状态）</li><li>性能优化建议（memo、useMemo、useCallback）</li><li>错误处理机制（Error Boundary、异常捕获）</li><li>安全规范（XSS 防护、数据验证）</li></ul></li></ol><p>平衡规范与效率:</p><ol><li>自动化工具：使用 ESLint + Prettier 自动修复，减少人工成本</li><li>渐进式推进：核心规则强制，非关键规则警告，逐步收紧</li><li>团队共识：规则由团队讨论决定，而非强制推行</li><li>灵活豁免：提供 eslint-disable 等机制应对特殊场景</li><li>持续优化：定期回顾规则有效性，删除过时规则</li><li><strong>使用业界标准配置：站在巨人的肩膀上，减少从零制定成本</strong><ul><li>直接使用成熟的 ESLint 配置（Airbnb、Umi、Ant Design）</li><li>在标准配置基础上微调，而非完全自定义</li><li>降低学习成本，新人更容易理解和接受</li></ul></li></ol><hr><h3 id="_2-eslint-工作原理" tabindex="-1"><a class="header-anchor" href="#_2-eslint-工作原理" aria-hidden="true">#</a> 2. ESLint 工作原理</h3><p>ESLint 的工作原理是什么？AST、规则引擎、修复器如何协同？自定义规则如何编写？</p><p><strong>【作答】：</strong></p><p>工作原理:</p><ol><li>解析（Parse）：将代码转换为 AST（抽象语法树）</li><li>遍历（Traverse）：遍历 AST 节点，触发规则监听器</li><li>检查（Check）：规则引擎执行各项规则检查</li><li>报告（Report）：收集错误和警告信息</li><li>修复（Fix）：自动修复可修复的问题</li></ol><p>AST 解析:</p><ul><li>ESLint 使用 espree 解析器（基于 Acorn）</li><li>将 JavaScript 代码解析为符合 ESTree 规范的 AST</li><li>支持最新的 ECMAScript 语法和 JSX</li><li>示例：const a = 1 → VariableDeclaration 节点 └─ VariableDeclarator ├─ Identifier (name: &quot;a&quot;) └─ Literal (value: 1)</li></ul><p>规则引擎:</p><ul><li>每个规则都是一个独立的模块，导出 create 函数</li><li>通过访问者模式（Visitor Pattern）监听 AST 节点</li><li>规则可监听进入/离开节点（如：Identifier、FunctionDeclaration）</li><li>规则之间相互独立，可插拔配置</li><li>支持规则级别：off(0)、warn(1)、error(2)</li></ul><p>自动修复:</p><ul><li>规则可提供 fix 函数，返回修复操作</li><li>通过 fixer API 操作代码：insertTextBefore、replaceText、remove</li><li>修复器支持范围操作，指定替换位置 [start, end]</li><li>多轮修复：某些修复可能触发其他规则，需要迭代修复</li><li>使用 --fix 参数自动修复</li></ul><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 自定义规则编写:</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">meta</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;problem&#39;</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">docs</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">description</span><span class="token operator">:</span> <span class="token string">&#39;禁止使用 var&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">fixable</span><span class="token operator">:</span> <span class="token string">&#39;code&#39;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n    <span class="token keyword">return</span> <span class="token punctuation">{</span>\n      <span class="token function">VariableDeclaration</span><span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">&#39;var&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n          context<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">{</span>\n            node<span class="token punctuation">,</span>\n            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;请使用 const 或 let&#39;</span><span class="token punctuation">,</span>\n            <span class="token function">fix</span><span class="token punctuation">(</span><span class="token parameter">fixer</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n              <span class="token keyword">return</span> fixer<span class="token punctuation">.</span><span class="token function">replaceText</span><span class="token punctuation">(</span>node<span class="token punctuation">,</span> node<span class="token punctuation">.</span>raw<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;var&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;const&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>\n            <span class="token punctuation">}</span>\n          <span class="token punctuation">}</span><span class="token punctuation">)</span>\n        <span class="token punctuation">}</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><hr><h3 id="_2-5-业界标准-eslint-配置-重点推荐" tabindex="-1"><a class="header-anchor" href="#_2-5-业界标准-eslint-配置-重点推荐" aria-hidden="true">#</a> 2.5. 业界标准 ESLint 配置（重点推荐）</h3><p><strong>为什么使用标准配置？</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>优势：\n1. 经过大量项目验证，规则成熟稳定\n2. 减少团队争论，&quot;业界标准&quot;就是最好的说服理由\n3. 开箱即用，大幅降低配置成本\n4. 社区活跃，持续更新维护\n5. 新人容易接受（很多人已经熟悉）\n\n原则：\n- 80% 使用标准配置，20% 根据团队定制\n- 优先选择与技术栈匹配的配置（React 选 Airbnb，Umi 项目选 @umijs/fabric）\n- 避免过度定制，增加维护成本\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>常见标准配置对比：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1. eslint-config-airbnb（最流行，React 项目首选）\n  npm install --save-dev eslint-config-airbnb eslint-plugin-import eslint-plugin-react eslint-plugin-react-hooks eslint-plugin-jsx-a11y\n\n  特点：\n  ✅ GitHub 4万+ Star，最受欢迎的配置\n  ✅ 规则严格，代码质量高\n  ✅ 完善的 React/JSX 支持\n  ✅ 包含无障碍性（a11y）规则\n  ❌ 规则较严，初期可能不适应\n\n  配置示例：\n  {\n    &quot;extends&quot;: [\n      &quot;airbnb&quot;,           // 完整版（包含 React）\n      &quot;airbnb-base&quot;       // 基础版（纯 JS，不含 React）\n    ]\n  }\n\n  适用场景：React/React Native 项目\n\n---\n\n2. @umijs/fabric（Umi/Ant Design 生态首选）\n  npm install --save-dev @umijs/fabric\n\n  特点：\n  ✅ 由蚂蚁集团前端团队维护\n  ✅ 针对 Umi + Ant Design + DVA 生态优化\n  ✅ 包含 ESLint + Prettier + Stylelint 全家桶\n  ✅ 内置 TypeScript 支持\n  ✅ 规则相对温和，适合国内团队\n\n  配置示例：\n  {\n    &quot;extends&quot;: [\n      &quot;@umijs/fabric&quot;     // 自动包含 eslint + prettier\n    ]\n  }\n\n  .prettierrc.js：\n  const fabric = require(&#39;@umijs/fabric&#39;);\n  module.exports = fabric.prettier;\n\n  适用场景：Umi/Ant Design Pro/中后台项目\n\n---\n\n3. eslint-config-standard（零配置，简洁风格）\n  npm install --save-dev eslint-config-standard eslint-plugin-import eslint-plugin-node eslint-plugin-promise\n\n  特点：\n  ✅ 零配置，开箱即用\n  ✅ 无分号风格（受 Vue 社区欢迎）\n  ✅ 规则宽松，易于上手\n  ❌ 缺少 React 专项规则\n\n  配置示例：\n  {\n    &quot;extends&quot;: [&quot;standard&quot;]\n  }\n\n  适用场景：Node.js/Vue 项目\n\n---\n\n4. eslint-config-google（Google 风格）\n  npm install --save-dev eslint-config-google\n\n  特点：\n  ✅ Google 官方风格指南\n  ✅ 规则保守，稳定性高\n  ❌ 社区不如 Airbnb 活跃\n\n  配置示例：\n  {\n    &quot;extends&quot;: [&quot;google&quot;]\n  }\n\n---\n\n5. @ant-design/eslint-config-antd（Ant Design 官方）\n  npm install --save-dev @ant-design/eslint-config-antd\n\n  特点：\n  ✅ Ant Design 官方维护\n  ✅ 专为 Ant Design 组件库优化\n  ✅ 适合 Ant Design 深度使用者\n\n  配置示例：\n  {\n    &quot;extends&quot;: [&quot;@ant-design&quot;]\n  }\n\n---\n\n6. eslint-config-alloy（腾讯 AlloyTeam 出品）\n  npm install --save-dev eslint-config-alloy\n\n  特点：\n  ✅ 腾讯团队维护\n  ✅ 支持 React/Vue/TypeScript\n  ✅ 规则详细，有中文注释\n\n  配置示例：\n  {\n    &quot;extends&quot;: [\n      &quot;alloy&quot;,\n      &quot;alloy/react&quot;,\n      &quot;alloy/typescript&quot;\n    ]\n  }\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br></div></div><p><strong>实战推荐配置（根据项目类型）：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>场景 1：Umi + Ant Design + TypeScript 项目（中后台）\n推荐：@umijs/fabric\n\npackage.json：\n{\n  &quot;devDependencies&quot;: {\n    &quot;@umijs/fabric&quot;: &quot;^3.0.0&quot;,\n    &quot;eslint&quot;: &quot;^8.0.0&quot;,\n    &quot;prettier&quot;: &quot;^3.0.0&quot;,\n    &quot;stylelint&quot;: &quot;^15.0.0&quot;\n  }\n}\n\n.eslintrc.js：\nmodule.exports = {\n  extends: [require.resolve(&#39;@umijs/fabric/dist/eslint&#39;)],\n\n  // 团队定制规则（仅少量调整）\n  rules: {\n    &#39;no-console&#39;: process__.env.NODE_ENV === &#39;production&#39; ? &#39;error&#39; : &#39;warn&#39;,\n    &#39;@typescript-eslint/no-unused-vars&#39;: [&#39;error&#39;, { argsIgnorePattern: &#39;^_&#39; }]\n  }\n}\n\n.prettierrc.js：\nconst fabric = require(&#39;@umijs/fabric&#39;);\nmodule.exports = fabric.prettier;\n\n.stylelintrc.js：\nmodule.exports = {\n  extends: [require.resolve(&#39;@umijs/fabric/dist/stylelint&#39;)]\n};\n\n---\n\n场景 2：React + TypeScript 通用项目\n推荐：Airbnb + TypeScript\n\npackage.json：\n{\n  &quot;devDependencies&quot;: {\n    &quot;eslint&quot;: &quot;^8.0.0&quot;,\n    &quot;eslint-config-airbnb&quot;: &quot;^19.0.0&quot;,\n    &quot;eslint-config-airbnb-typescript&quot;: &quot;^17.0.0&quot;,\n    &quot;@typescript-eslint/eslint-plugin&quot;: &quot;^6.0.0&quot;,\n    &quot;@typescript-eslint/parser&quot;: &quot;^6.0.0&quot;,\n    &quot;eslint-plugin-import&quot;: &quot;^2.28.0&quot;,\n    &quot;eslint-plugin-jsx-a11y&quot;: &quot;^6.7.0&quot;,\n    &quot;eslint-plugin-react&quot;: &quot;^7.33.0&quot;,\n    &quot;eslint-plugin-react-hooks&quot;: &quot;^4.6.0&quot;\n  }\n}\n\n.eslintrc.js：\nmodule.exports = {\n  extends: [\n    &#39;airbnb&#39;,\n    &#39;airbnb-typescript&#39;,\n    &#39;airbnb/hooks&#39;\n  ],\n  parserOptions: {\n    project: &#39;./tsconfig.json&#39;\n  },\n  rules: {\n    // 团队定制\n    &#39;react/react-in-jsx-scope&#39;: &#39;off&#39;,  // React 17+ 不需要导入 React\n    &#39;import/prefer-default-export&#39;: &#39;off&#39;,\n    &#39;@typescript-eslint/no-unused-vars&#39;: [&#39;error&#39;, { argsIgnorePattern: &#39;^_&#39; }]\n  }\n}\n\n---\n\n场景 3：Node.js/Vue 项目\n推荐：Standard\n\npackage.json：\n{\n  &quot;devDependencies&quot;: {\n    &quot;eslint&quot;: &quot;^8.0.0&quot;,\n    &quot;eslint-config-standard&quot;: &quot;^17.0.0&quot;,\n    &quot;eslint-plugin-vue&quot;: &quot;^9.0.0&quot;\n  }\n}\n\n.eslintrc.js：\nmodule.exports = {\n  extends: [\n    &#39;standard&#39;,\n    &#39;plugin:vue/vue3-recommended&#39;\n  ]\n}\n\n---\n\n场景 4：从零开始，没有历史包袱\n推荐：@umijs/fabric（国内团队） 或 Airbnb（国际化团队）\n\n理由：\n- @umijs/fabric：中文文档，国内最佳实践，全家桶配置\n- Airbnb：国际标准，社区最活跃\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br></div></div><p><strong>如何选择配置？决策树：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>是否使用 Umi 框架？\n├─ 是 → @umijs/fabric（官方推荐，零配置）\n└─ 否 → 是否使用 React？\n      ├─ 是 → 是否使用 TypeScript？\n      │      ├─ 是 → airbnb + airbnb-typescript\n      │      └─ 否 → airbnb\n      └─ 否 → 是否使用 Vue？\n              ├─ 是 → standard + plugin:vue\n              └─ 否 → standard（Node.js 项目）\n\n特殊场景：\n- Ant Design 组件库开发 → @ant-design/eslint-config-antd\n- 腾讯系项目 → eslint-config-alloy\n- Google 风格偏好 → eslint-config-google\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>配置继承与定制：</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 推荐做法：基于标准配置微调</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 1. 继承标准配置（80%）</span>\n  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;@umijs/fabric/dist/eslint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n  <span class="token comment">// 2. 团队定制规则（20%）</span>\n  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 关闭不合适的规则</span>\n    <span class="token string-property property">&#39;no-console&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 调整规则级别</span>\n    <span class="token literal-property property">complexity</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;warn&#39;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 降低复杂度要求</span>\n\n    <span class="token comment">// 添加团队特殊规则</span>\n    <span class="token string-property property">&#39;no-restricted-imports&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span>\n        <span class="token literal-property property">patterns</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;../*&#39;</span><span class="token punctuation">]</span> <span class="token comment">// 禁止相对路径导入上级目录</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  <span class="token comment">// 3. 特殊目录配置</span>\n  <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n      <span class="token literal-property property">files</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;**/*.test.ts&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;**/*.spec.ts&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&#39;@typescript-eslint/no-explicit-any&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span> <span class="token comment">// 测试文件允许 any</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><strong>Umi 项目完整配置示例（推荐）：</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;@umijs/fabric/dist/eslint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">globals</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token constant">ANT_DESIGN_PRO_ONLY_DO_NOT_USE_IN_YOUR_PRODUCTION</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>\n    <span class="token literal-property property">page</span><span class="token operator">:</span> <span class="token boolean">true</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 生产环境禁止 console</span>\n    <span class="token string-property property">&#39;no-console&#39;</span><span class="token operator">:</span> process__<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;error&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;warn&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 允许下划线开头的未使用参数（常见于回调函数）</span>\n    <span class="token string-property property">&#39;@typescript-eslint/no-unused-vars&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span> <span class="token literal-property property">argsIgnorePattern</span><span class="token operator">:</span> <span class="token string">&#39;^_&#39;</span><span class="token punctuation">,</span> <span class="token literal-property property">varsIgnorePattern</span><span class="token operator">:</span> <span class="token string">&#39;^_&#39;</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 允许命名导出</span>\n    <span class="token string-property property">&#39;import/prefer-default-export&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// React 17+ 不需要导入 React</span>\n    <span class="token string-property property">&#39;react/react-in-jsx-scope&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 允许 JSX 在 tsx 文件中</span>\n    <span class="token string-property property">&#39;react/jsx-filename-extension&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;.tsx&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// .prettierrc.js</span>\n<span class="token keyword">const</span> fabric <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@umijs/fabric&#39;</span><span class="token punctuation">)</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>fabric<span class="token punctuation">.</span>prettier<span class="token punctuation">,</span>\n  <span class="token comment">// 团队定制（可选）</span>\n  <span class="token literal-property property">printWidth</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 行宽 100（默认 80）</span>\n  <span class="token literal-property property">singleQuote</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 单引号</span>\n  <span class="token literal-property property">trailingComma</span><span class="token operator">:</span> <span class="token string">&#39;es5&#39;</span> <span class="token comment">// 尾随逗号</span>\n<span class="token punctuation">}</span>\n\n<span class="token comment">// .stylelintrc.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;@umijs/fabric/dist/stylelint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 定制 CSS 规则</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p><strong>最佳实践建议：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1. 优先选择标准配置\n  ❌ 从零开始编写 100+ 条规则\n  ✅ 使用 @umijs/fabric 或 Airbnb，微调 5-10 条规则\n\n2. 根据技术栈选择\n  - Umi 生态 → @umijs/fabric\n  - React 通用 → Airbnb\n  - Vue → Standard + vue\n  - Node.js → Standard\n\n3. 团队定制不超过 20%\n  - 保留 80% 的标准配置\n  - 只调整真正不适合团队的规则\n  - 避免过度定制\n\n4. 定期更新配置包\n  - 每季度更新一次 @umijs/fabric 等配置包\n  - 查看 Changelog，了解新规则\n  - 渐进式采纳新规则\n\n5. 文档化定制原因\n  // ✅ 好的做法\n  rules: {\n    // 团队约定：业务代码允许 console.log 用于调试\n    &#39;no-console&#39;: &#39;off&#39;\n  }\n\n  // ❌ 不好的做法\n  rules: {\n    &#39;no-console&#39;: &#39;off&#39;  // 为什么关闭？\n  }\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><hr><h3 id="_3-prettier-vs-eslint" tabindex="-1"><a class="header-anchor" href="#_3-prettier-vs-eslint" aria-hidden="true">#</a> 3. Prettier vs ESLint</h3><p>Prettier 和 ESLint 的区别是什么？为什么需要两者配合？如何避免冲突？</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Prettier:\n- 定位：代码格式化工具（Opinionated Code Formatter）\n- 职责：专注于代码风格/格式（缩进、换行、引号、分号等）\n- 特点：\n  · 几乎无配置，开箱即用\n  · 不可定制性强（减少争议）\n  · 支持多语言（JS、TS、CSS、HTML、JSON、Markdown等）\n  · 只管格式，不管代码质量\n\nESLint:\n- 定位：代码质量检查工具（Code Quality Linter）\n- 职责：代码质量 + 部分代码风格检查\n- 特点：\n  · 高度可配置（规则、插件、解析器）\n  · 可检查潜在错误（未使用变量、==误用等）\n  · 可自定义规则\n  · 支持自动修复（但不如 Prettier 全面）\n\n两者配合:\n1. 分工明确：\n   - Prettier 负责格式化（缩进、换行、空格）\n   - ESLint 负责代码质量（逻辑错误、最佳实践）\n\n2. 协作流程：\n   - 先执行 Prettier 格式化\n   - 再执行 ESLint 检查代码质量\n   - 在 IDE 保存时自动触发\n\n3. 优势互补：\n   - Prettier 保证格式统一，减少 ESLint 格式规则\n   - ESLint 保证代码质量，发现潜在 Bug\n   - 提升开发体验，减少代码审查成本\n\n避免冲突:\n1. 使用 eslint-config-prettier：\n   - 关闭所有与 Prettier 冲突的 ESLint 格式规则\n   - 安装：npm i -D eslint-config-prettier\n   - 配置：extends: [&#39;prettier&#39;] // 放在最后\n\n2. 使用 eslint-plugin-prettier（可选）：\n   - 将 Prettier 作为 ESLint 规则运行\n   - 格式问题会显示为 ESLint 错误\n   - 配置：extends: [&#39;plugin:prettier/recommended&#39;]\n\n3. 推荐配置：\n   {\n     &quot;extends&quot;: [\n       &quot;eslint:recommended&quot;,\n       &quot;plugin:react/recommended&quot;,\n       &quot;prettier&quot;  // 必须放在最后，关闭冲突规则\n     ],\n     &quot;plugins&quot;: [&quot;prettier&quot;],\n     &quot;rules&quot;: {\n       &quot;prettier/prettier&quot;: &quot;error&quot;\n     }\n   }\n\n4. 编辑器集成：\n   - VSCode 安装 Prettier 和 ESLint 插件\n   - 配置保存时自动格式化：\n     &quot;editor.formatOnSave&quot;: true,\n     &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><hr><h3 id="_4-umi-规范设计" tabindex="-1"><a class="header-anchor" href="#_4-umi-规范设计" aria-hidden="true">#</a> 4. Umi 规范设计</h3><p>Umi 的规范为什么这样设计（约定式路由、配置式路由、插件机制）？背后的设计哲学是什么？</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>约定式路由:\n- 基于文件系统的路由（Convention over Configuration）\n- 目录结构即路由结构：\n  pages/\n    index.tsx        → /\n    users/\n      index.tsx      → /users\n      [id].tsx       → /users/:id\n      [id]/edit.tsx  → /users/:id/edit\n\n- 优势：\n  · 零配置，开箱即用\n  · 目录结构即文档，一目了然\n  · 自动生成路由配置\n  · 减少心智负担\n\n- 特殊文件：\n  · _layout.tsx：布局文件\n  · 404.tsx：404 页面\n  · $.tsx：通配符路由\n\n配置式路由:\n- 通过 .umirc.ts 或 config/config.ts 配置\n- 适用场景：\n  · 复杂权限控制\n  · 动态路由需求\n  · 需要精细控制路由行为\n  · 路由元信息配置（title、access 等）\n\n- 示例配置：\n  export default {\n    routes: [\n      { path: &#39;/&#39;, component: &#39;@/pages/index&#39; },\n      {\n        path: &#39;/admin&#39;,\n        component: &#39;@/layouts/AdminLayout&#39;,\n        access: &#39;canAdmin&#39;,\n        routes: [\n          { path: &#39;/admin/users&#39;, component: &#39;@/pages/users&#39; }\n        ]\n      }\n    ]\n  }\n\n- 优势：\n  · 灵活性强，可精确控制\n  · 支持路由级权限配置\n  · 可配置路由元信息\n\n插件机制:\n- Umi 采用插件化架构，核心功能都是插件\n- 插件生命周期：\n  · onPluginReady：插件准备完成\n  · modifyConfig：修改配置\n  · modifyPaths：修改路径\n  · onGenerateFiles：生成临时文件\n  · modifyWebpackConfig：修改 Webpack 配置\n\n- 官方插件：\n  · @umijs/plugin-access：权限管理\n  · @umijs/plugin-model：简易数据流\n  · @umijs/plugin-antd：Ant Design 集成\n  · @umijs/plugin-request：网络请求\n\n- 自定义插件：\n  export default (api) =&gt; {\n    api.describe({ key: &#39;myPlugin&#39; })\n    api.modifyConfig((memo) =&gt; {\n      // 修改配置\n      return memo\n    })\n  }\n\n设计哲学:\n1. 约定优于配置（Convention over Configuration）\n   - 减少配置文件，降低学习成本\n   - 通过约定降低决策成本\n   - 保持一致性，提升团队协作效率\n\n2. 渐进式增强（Progressive Enhancement）\n   - 默认提供最佳实践（路由、构建、部署）\n   - 需要时可深度定制（配置式路由、插件）\n   - 满足不同复杂度项目需求\n\n3. 开箱即用（Out of the Box）\n   - 内置路由、构建、Mock、代理等功能\n   - 零配置启动项目\n   - 降低项目初始化成本\n\n4. 插件化（Plugin System）\n   - 核心功能插件化，按需加载\n   - 生态丰富，社区活跃\n   - 可扩展性强\n\n5. 企业级（Enterprise-ready）\n   - 面向中后台应用场景\n   - 内置权限、国际化、数据流等企业级需求\n   - 稳定性和性能优先\n\n6. 研发体验优先\n   - 快速热更新\n   - 友好的错误提示\n   - 完善的文档和示例\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br></div></div><hr><h3 id="_5-git-hooks-与规范落地" tabindex="-1"><a class="header-anchor" href="#_5-git-hooks-与规范落地" aria-hidden="true">#</a> 5. Git Hooks 与规范落地</h3><p>如何用 Git Hooks（husky、lint-staged、commitlint）落地代码规范？完整的工作流是什么?</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>husky:\n- 定位：Git Hooks 管理工具\n- 作用：在 Git 操作时自动触发脚本（如：pre-commit、commit-msg）\n- 安装配置：\n  npm install husky -D\n  npx husky install\n  npm pkg set scripts.prepare=&quot;husky install&quot;\n  npx husky add .husky/pre-commit &quot;npx lint-staged&quot;\n  npx husky add .husky/commit-msg &quot;npx commitlint --edit $1&quot;\n\n- 常用 Hooks：\n  · pre-commit：提交前检查（代码格式、lint）\n  · commit-msg：提交信息检查（规范性）\n  · pre-push：推送前检查（测试、构建）\n\n- 优势：\n  · 统一团队 Git Hooks 配置\n  · 自动安装，无需手动配置\n  · 跨平台兼容\n\nlint-staged:\n- 定位：只对暂存区文件执行 lint\n- 作用：提升性能，只检查本次修改的文件\n- 配置（package.json）：\n  {\n    &quot;lint-staged&quot;: {\n      &quot;*.{js,jsx,ts,tsx}&quot;: [\n        &quot;eslint --fix&quot;,\n        &quot;prettier --write&quot;\n      ],\n      &quot;*.{css,less,scss}&quot;: [\n        &quot;stylelint --fix&quot;,\n        &quot;prettier --write&quot;\n      ],\n      &quot;*.{json,md}&quot;: [\n        &quot;prettier --write&quot;\n      ]\n    }\n  }\n\n- 工作流程：\n  1. git add 文件到暂存区\n  2. git commit 触发 pre-commit\n  3. lint-staged 获取暂存文件列表\n  4. 对匹配的文件执行命令\n  5. 自动 git add 修复后的文件\n  6. 继续提交流程\n\n- 优势：\n  · 只检查修改文件，速度快\n  · 自动修复并重新暂存\n  · 支持多种文件类型\n\ncommitlint:\n- 定位：Git 提交信息规范检查工具\n- 作用：强制团队使用统一的提交信息格式\n- 安装配置：\n  npm install @commitlint/{cli,config-conventional} -D\n  echo &quot;module.exports = {extends: [&#39;@commitlint/config-conventional&#39;]}&quot; &gt; commitlint.config.js\n\n- 规范格式（Conventional Commits）：\n  &lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;\n\n  &lt;body&gt;\n\n  &lt;footer&gt;\n\n- type 类型：\n  · feat：新功能\n  · fix：bug 修复\n  · docs：文档修改\n  · style：代码格式（不影响功能）\n  · refactor：重构\n  · perf：性能优化\n  · test：测试相关\n  · chore：构建/工具变动\n\n- 示例：\n  feat(user): 添加用户登录功能\n  fix(api): 修复接口超时问题\n  docs(readme): 更新安装文档\n\n完整工作流:\n1. 开发阶段：\n   - 编写代码\n   - IDE 保存时自动格式化（Prettier）\n   - 实时 ESLint 错误提示\n\n2. 提交前（pre-commit）：\n   git add .\n   git commit -m &quot;feat: xxx&quot;\n   ↓\n   触发 husky pre-commit hook\n   ↓\n   执行 lint-staged\n   ↓\n   - ESLint 检查并自动修复\n   - Prettier 格式化\n   - Stylelint 检查样式\n   ↓\n   检查通过 → 继续提交\n   检查失败 → 阻止提交，显示错误\n\n3. 提交信息检查（commit-msg）：\n   ↓\n   触发 husky commit-msg hook\n   ↓\n   执行 commitlint\n   ↓\n   检查提交信息格式\n   ↓\n   符合规范 → 完成提交\n   不符合 → 阻止提交，提示错误\n\n4. 推送前（pre-push，可选）：\n   git push\n   ↓\n   触发 husky pre-push hook\n   ↓\n   - 执行单元测试\n   - 执行构建检查\n   - 执行类型检查（tsc --noEmit）\n   ↓\n   检查通过 → 允许推送\n   检查失败 → 阻止推送\n\n5. CI/CD 阶段：\n   - 再次执行 ESLint 全量检查\n   - 执行完整测试套件\n   - 生成代码质量报告\n   - 构建部署\n\n完整配置示例（package.json）：\n{\n  &quot;scripts&quot;: {\n    &quot;prepare&quot;: &quot;husky install&quot;,\n    &quot;lint&quot;: &quot;eslint src --ext .js,.jsx,.ts,.tsx&quot;,\n    &quot;lint:fix&quot;: &quot;eslint src --ext .js,.jsx,.ts,.tsx --fix&quot;,\n    &quot;format&quot;: &quot;prettier --write \\&quot;src/**/*.{js,jsx,ts,tsx,css,less,json,md}\\&quot;&quot;\n  },\n  &quot;lint-staged&quot;: {\n    &quot;*.{js,jsx,ts,tsx}&quot;: [&quot;eslint --fix&quot;, &quot;prettier --write&quot;],\n    &quot;*.{css,less}&quot;: [&quot;stylelint --fix&quot;, &quot;prettier --write&quot;]\n  },\n  &quot;devDependencies&quot;: {\n    &quot;husky&quot;: &quot;^8.0.0&quot;,\n    &quot;lint-staged&quot;: &quot;^13.0.0&quot;,\n    &quot;@commitlint/cli&quot;: &quot;^17.0.0&quot;,\n    &quot;@commitlint/config-conventional&quot;: &quot;^17.0.0&quot;\n  }\n}\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br></div></div><hr><h3 id="_6-typescript-类型规范" tabindex="-1"><a class="header-anchor" href="#_6-typescript-类型规范" aria-hidden="true">#</a> 6. TypeScript 类型规范</h3><p>TypeScript 项目的类型规范应该如何制定？any 的使用原则、类型覆盖率、严格模式配置？</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>any 使用原则:\n1. 禁止使用场景：\n   - 业务逻辑代码中禁止使用 any\n   - 公共组件/工具函数禁止使用 any\n   - 接口定义禁止使用 any\n\n2. 允许使用场景（需添加注释说明）：\n   - 第三方库没有类型定义（临时方案，应补充 @types）\n   - 复杂类型推导性能问题（极少数情况）\n   - 动态数据类型确实无法预知（需业务说明）\n\n3. 替代方案：\n   - 使用 unknown 替代 any（类型安全）\n   - 使用泛型 &lt;T&gt; 保持类型信息\n   - 使用联合类型 string | number\n   - 使用类型断言 as Type（谨慎使用）\n\n4. ESLint 规则：\n   @typescript-eslint/no-explicit-any: &quot;error&quot;\n   @typescript-eslint/no-unsafe-assignment: &quot;warn&quot;\n\n5. 示例对比：\n   ❌ 错误：function process__(data: any) { return data.value }\n   ✅ 正确：function process__&lt;T&gt;(data: T) { return data }\n   ✅ 正确：function process__(data: unknown) {\n              if (typeof data === &#39;object&#39;) { ... }\n            }\n\n类型覆盖率:\n1. 目标设定：\n   - 核心业务代码：&gt;95%\n   - 工具函数：100%\n   - 组件库：100%\n   - 测试代码：&gt;80%\n\n2. 检测工具：\n   - 使用 type-coverage 检查类型覆盖率\n     npx type-coverage --detail\n   - 在 CI 中配置最低覆盖率阈值\n   - 生成类型覆盖率报告\n\n3. 配置示例（package.json）：\n   {\n     &quot;scripts&quot;: {\n       &quot;type-check&quot;: &quot;tsc --noEmit&quot;,\n       &quot;type-coverage&quot;: &quot;type-coverage --at-least 95&quot;\n     },\n     &quot;typeCoverage&quot;: {\n       &quot;atLeast&quot;: 95,\n       &quot;strict&quot;: true,\n       &quot;ignoreFiles&quot;: [&quot;**/*.spec.ts&quot;, &quot;**/mock/**&quot;]\n     }\n   }\n\n4. 提升覆盖率策略：\n   - 优先处理覆盖率低的核心模块\n   - 为第三方库补充 .d.ts 声明文件\n   - 重构 any 类型为具体类型\n   - 使用泛型增强类型推导\n\n严格模式配置:\ntsconfig.json 推荐配置：\n{\n  &quot;compilerOptions&quot;: {\n    // 严格模式（开启所有严格检查）\n    &quot;strict&quot;: true,\n\n    // 或单独配置各项严格检查：\n    &quot;noImplicitAny&quot;: true,              // 禁止隐式 any\n    &quot;strictNullChecks&quot;: true,           // 严格空值检查\n    &quot;strictFunctionTypes&quot;: true,        // 严格函数类型检查\n    &quot;strictBindCallApply&quot;: true,        // 严格 bind/call/apply\n    &quot;strictPropertyInitialization&quot;: true, // 严格属性初始化\n    &quot;noImplicitThis&quot;: true,             // 禁止隐式 this\n    &quot;alwaysStrict&quot;: true,               // 始终启用严格模式\n\n    // 额外的严格检查\n    &quot;noUnusedLocals&quot;: true,             // 未使用的局部变量\n    &quot;noUnusedParameters&quot;: true,         // 未使用的参数\n    &quot;noImplicitReturns&quot;: true,          // 函数必须有返回值\n    &quot;noFallthroughCasesInSwitch&quot;: true, // switch 必须有 break\n    &quot;noUncheckedIndexedAccess&quot;: true,   // 索引访问可能为 undefined\n    &quot;noPropertyAccessFromIndexSignature&quot;: true, // 索引签名访问\n\n    // 模块解析\n    &quot;esModuleInterop&quot;: true,\n    &quot;allowSyntheticDefaultImports&quot;: true,\n    &quot;moduleResolution&quot;: &quot;node&quot;,\n\n    // 其他\n    &quot;skipLibCheck&quot;: true,               // 跳过库文件检查（提升性能）\n    &quot;forceConsistentCasingInFileNames&quot;: true\n  }\n}\n\n类型规范实践:\n1. 接口定义规范：\n   // ✅ 使用 interface 定义对象结构\n   interface User {\n     id: number\n     name: string\n     email?: string  // 可选属性\n     readonly createdAt: Date  // 只读属性\n   }\n\n   // ✅ 使用 type 定义联合类型/工具类型\n   type Status = &#39;pending&#39; | &#39;success&#39; | &#39;error&#39;\n   type Partial&lt;T&gt; = { [P in keyof T]?: T[P] }\n\n2. 函数类型规范：\n   // ✅ 明确参数和返回值类型\n   function fetchUser(id: number): Promise&lt;User&gt; {\n     return api.get(`/users/${id}`)\n   }\n\n   // ✅ 使用泛型增强复用性\n   function mapArray&lt;T, U&gt;(arr: T[], fn: (item: T) =&gt; U): U[] {\n     return arr.map(fn)\n   }\n\n3. React 组件类型规范：\n   // ✅ 使用 FC 或显式定义 props\n   interface ButtonProps {\n     text: string\n     onClick: () =&gt; void\n     disabled?: boolean\n   }\n\n   const Button: React.FC&lt;ButtonProps&gt; = ({ text, onClick, disabled }) =&gt; {\n     return &lt;button onClick={onClick} disabled={disabled}&gt;{text}&lt;/button&gt;\n   }\n\n   // ✅ 使用泛型组件\n   interface ListProps&lt;T&gt; {\n     items: T[]\n     renderItem: (item: T) =&gt; React.ReactNode\n   }\n\n   function List&lt;T&gt;({ items, renderItem }: ListProps&lt;T&gt;) {\n     return &lt;&gt;{items.map(renderItem)}&lt;/&gt;\n   }\n\n4. 工具类型使用：\n   // Partial：所有属性可选\n   type PartialUser = Partial&lt;User&gt;\n\n   // Required：所有属性必填\n   type RequiredUser = Required&lt;User&gt;\n\n   // Pick：选择部分属性\n   type UserBasic = Pick&lt;User, &#39;id&#39; | &#39;name&#39;&gt;\n\n   // Omit：排除部分属性\n   type UserWithoutEmail = Omit&lt;User, &#39;email&#39;&gt;\n\n   // Record：定义键值对\n   type UserMap = Record&lt;number, User&gt;\n\n5. 类型守卫：\n   function isUser(obj: any): obj is User {\n     return typeof obj === &#39;object&#39; &amp;&amp; &#39;id&#39; in obj &amp;&amp; &#39;name&#39; in obj\n   }\n\n   if (isUser(data)) {\n     // TypeScript 知道 data 是 User 类型\n     console.log(data.name)\n   }\n\n6. 避免类型断言滥用：\n   // ❌ 危险的类型断言\n   const user = data as User\n\n   // ✅ 使用类型守卫\n   if (isUser(data)) {\n     const user = data\n   }\n\n   // ✅ 使用类型收窄\n   if (typeof value === &#39;string&#39;) {\n     // TypeScript 自动推导 value 为 string\n   }\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br></div></div><hr><h2 id="面试题-4-题" tabindex="-1"><a class="header-anchor" href="#面试题-4-题" aria-hidden="true">#</a> 面试题（4 题）</h2><h3 id="_1-团队规范落地" tabindex="-1"><a class="header-anchor" href="#_1-团队规范落地" aria-hidden="true">#</a> 1. 团队规范落地</h3><p>如果让你在团队推行代码规范，你会如何做？从制定、宣导、落地、监控到持续改进。</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>第一阶段：调研与制定（1-2周）\n1. 现状调研：\n   - 统计团队现有代码风格（缩进、命名、架构）\n   - 收集团队成员痛点（代码审查争议点、常见 Bug）\n   - 调研业界标准（Airbnb、Google、Standard）\n\n2. 规范制定（关键：不要从零开始！）：\n   - **直接采用成熟的标准配置**（80% 工作已完成）：\n     · Umi 项目 → @umijs/fabric（蚂蚁官方，全家桶）\n     · React 项目 → eslint-config-airbnb（社区最流行）\n     · Vue 项目 → eslint-config-standard + plugin:vue\n     · Node.js → eslint-config-standard\n\n   - **团队定制**（仅 20%）：\n     · 只调整真正不适合团队的规则（如 max-lines、complexity）\n     · 基于实际痛点定制，避免过度配置\n     · 记录每条定制规则的原因\n\n   - **达成共识**：\n     · 组织团队讨论会，投票决定使用哪个标准配置\n     · 用&quot;业界标准&quot;说服成员，减少主观争论\n     · 输出简洁的规范文档（标准配置 + 团队定制）\n\n3. 工具选型（推荐方案）：\n   - **Umi 项目**：\n     npm install -D @umijs/fabric\n     → 自动包含 ESLint + Prettier + Stylelint + TypeScript 配置\n\n   - **React 项目**：\n     npm install -D eslint-config-airbnb-typescript\n     → Airbnb 规范 + TypeScript 支持\n\n   - **通用工具**：\n     · husky + lint-staged（Git Hooks）\n     · commitlint（提交信息规范）\n     · TypeScript strict mode\n\n第二阶段：试点与宣导（2-3周）\n1. 小范围试点：\n   - 选择 1-2 个新项目先行试点\n   - 收集反馈，优化规则配置\n   - 总结最佳实践和常见问题\n\n2. 团队宣导：\n   - 组织技术分享会，讲解规范意义和工具使用\n   - 编写新手指南和 FAQ 文档\n   - 录制视频教程（IDE 配置、插件安装）\n   - 建立答疑渠道（Slack/飞书群）\n\n3. 开发环境配置：\n   - 提供统一的 VSCode 配置文件（.vscode/settings.json）\n   - 编写一键配置脚本（安装依赖、配置插件）\n   - 提供项目模板（create-react-app + 规范配置）\n\n第三阶段：全面落地（1个月）\n1. 存量代码处理（渐进式）：\n   - 不强制改造存量代码（避免大规模冲突）\n   - 在修改文件时顺带修复（减少变更范围）\n   - 设置 .eslintignore 忽略历史代码\n   - 逐步清理技术债务\n\n2. 增量代码强制（Git Hooks）：\n   - 所有新代码必须通过 lint 检查\n   - pre-commit：lint-staged 自动修复\n   - commit-msg：commitlint 检查提交信息\n   - pre-push：类型检查和单元测试\n\n3. CI/CD 集成：\n   - 在 CI 流程中强制执行 lint 检查\n   - 生成质量报告（ESLint、类型覆盖率）\n   - 检查不通过则阻止合并/部署\n\n   示例（.gitlab-ci.yml）：\n   lint:\n     script:\n       - npm run lint\n       - npm run type-check\n       - npm run type-coverage\n\n第四阶段：监控与度量（持续）\n1. 数据收集：\n   - 统计每次 MR 的 lint 错误数量\n   - 统计类型覆盖率趋势\n   - 统计代码质量评分（SonarQube）\n   - 统计 Bug 率变化\n\n2. 质量报告：\n   - 每周发布质量周报（错误 Top10、改进趋势）\n   - 在团队会议上同步质量数据\n   - 表彰规范执行好的成员\n\n3. 代码审查强化：\n   - 在 Code Review 中强调规范执行\n   - 建立 CR Checklist（规范项、安全项、性能项）\n   - 培养团队规范意识\n\n第五阶段：持续改进（季度）\n1. 定期回顾（每季度）：\n   - 收集规则争议点和误报问题\n   - 评估规则有效性（是否真正减少 Bug）\n   - 删除无效规则，优化配置\n\n2. 规范演进：\n   - 跟进 ESLint/TypeScript 新特性\n   - 引入新工具（如 SonarQube、Codecov）\n   - 补充新的最佳实践（性能、安全）\n\n3. 团队能力建设：\n   - 分享优秀代码案例\n   - 组织规范培训（新人入职培训）\n   - 鼓励贡献自定义规则\n\n关键成功因素：\n✅ 自动化优先：减少人工干预，降低执行成本\n✅ 渐进式推进：先试点后推广，先增量后存量\n✅ 数据驱动：用数据说话，证明规范价值\n✅ 持续优化：规范是动态的，不是一成不变\n✅ 团队共识：规范不是强制，是团队约定\n\n潜在阻力与应对：\n1. &quot;规范太严格，影响开发效率&quot;\n   → 强调自动修复，实际上是提升效率\n   → 展示数据：规范后 Bug 率下降 30%，CR 时间减少 50%\n\n2. &quot;历史代码改造成本太高&quot;\n   → 采用渐进式策略，不强制改造存量代码\n   → 只对新增/修改代码执行规范\n\n3. &quot;规则太多，记不住&quot;\n   → 依赖工具自动检查和修复，不需要记忆\n   → 提供配置好的开发环境，开箱即用\n\n4. &quot;某些规则不合理&quot;\n   → 建立规则讨论机制，民主决策\n   → 提供豁免机制（eslint-disable + 注释说明）\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br></div></div><hr><h3 id="_2-规范与灵活性" tabindex="-1"><a class="header-anchor" href="#_2-规范与灵活性" aria-hidden="true">#</a> 2. 规范与灵活性</h3><p>代码规范如何平衡&quot;统一性&quot;与&quot;灵活性&quot;？什么情况下可以豁免规则？如何设计例外机制？</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>一、平衡统一性与灵活性的策略\n\n1. 分层规则设计：\n   - Error 级别（强制，阻止提交）：\n     · 可能导致 Bug 的规则（如 no-unused-vars）\n     · 安全相关规则（如 no-eval）\n     · 类型安全规则（如 @typescript-eslint/no-explicit-any）\n\n   - Warn 级别（警告，不阻止提交）：\n     · 代码质量建议（如 complexity 复杂度）\n     · 性能优化建议（如 react-hooks/exhaustive-deps）\n     · 风格偏好（如 prefer-const）\n\n   - Off 级别（关闭）：\n     · 团队认为不适用的规则\n     · 与项目特性冲突的规则\n\n2. 核心规则 + 可选规则：\n   - 核心规则（20%）：所有项目必须遵守\n     · 格式化（Prettier 全权处理）\n     · 明显错误（no-undef、no-unreachable）\n     · 安全问题（no-eval、no-implied-eval）\n\n   - 可选规则（80%）：各项目根据情况选择\n     · 命名风格（驼峰/下划线）\n     · 文件组织方式\n     · 注释要求\n\n3. 项目级定制：\n   - 全局配置（.eslintrc.js）：团队统一规则\n   - 项目级覆盖（project/.eslintrc.js）：特殊项目定制\n   - 目录级覆盖（src/legacy/.eslintrc.js）：老代码兼容\n\n   示例：\n   // 全局配置\n   module.exports = {\n     extends: [&#39;@company/eslint-config&#39;]\n   }\n\n   // 项目级定制\n   module.exports = {\n     extends: [&#39;@company/eslint-config&#39;],\n     rules: {\n       &#39;max-lines&#39;: [&#39;warn&#39;, 500]  // 覆盖全局配置\n     }\n   }\n\n二、可以豁免规则的场景\n\n1. 技术原因：\n   ✅ 第三方库类型缺失：\n      // @ts-ignore: 第三方库 xyz 缺少类型定义，已提 Issue #123\n      import xyz from &#39;xyz&#39;\n\n   ✅ 性能优化需要：\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      useEffect(() =&gt; {\n        // 只在首次渲染时执行，故意不添加依赖\n        initSDK()\n      }, [])\n\n   ✅ 算法逻辑复杂度：\n      // eslint-disable-next-line complexity\n      function complexBusinessLogic() {\n        // 业务逻辑确实复杂，无法拆分\n      }\n\n2. 业务原因：\n   ✅ 遗留代码兼容：\n      // .eslintignore\n      src/legacy/**/*\n      src/vendor/**/*\n\n   ✅ 自动生成代码：\n      /* eslint-disable */\n      // 此文件由工具自动生成，请勿手动修改\n      export const API = { ... }\n      /* eslint-enable */\n\n   ✅ 测试代码特殊性：\n      // test/.eslintrc.js\n      module.exports = {\n        rules: {\n          &#39;@typescript-eslint/no-explicit-any&#39;: &#39;off&#39;,  // 测试代码允许 any\n          &#39;max-lines&#39;: &#39;off&#39;  // 测试文件可以很长\n        }\n      }\n\n3. 临时豁免：\n   ✅ 快速修复线上问题（事后补充 TODO）：\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      // TODO: 临时修复，待重构时补充类型 @张三 2024-12-28\n      const temp: any = legacyData\n\n三、例外机制设计\n\n1. 内联注释（最常用）：\n   - 单行豁免：\n     // eslint-disable-next-line rule-name\n     const x = dangerous()\n\n   - 块级豁免：\n     /* eslint-disable rule-name */\n     const a = 1\n     const b = 2\n     /* eslint-enable rule-name */\n\n   - 文件级豁免：\n     /* eslint-disable */\n     // 整个文件忽略\n\n   - TypeScript 忽略：\n     // @ts-ignore: 说明原因\n     // @ts-expect-error: 期望报错（用于测试）\n     // @ts-nocheck: 整个文件不检查\n\n2. 豁免规范（强制要求）：\n   ❌ 禁止：无注释的豁免\n   // eslint-disable-next-line\n\n   ✅ 要求：必须说明原因\n   // eslint-disable-next-line no-console\n   // 保留 console 用于调试生产环境问题\n   console.log(&#39;debug:&#39;, data)\n\n   ✅ 要求：指定具体规则（不使用 eslint-disable 全局禁用）\n\n   ✅ 要求：临时豁免必须添加 TODO 和负责人\n   // eslint-disable-next-line @typescript-eslint/no-explicit-any\n   // TODO: 补充类型定义 @张三 #123\n\n3. 豁免审查流程：\n   - 在 Code Review 中重点关注豁免代码\n   - 检查豁免原因是否充分\n   - 评估是否有更好的解决方案\n   - 临时豁免必须创建 Issue 跟踪\n\n   CR Checklist:\n   □ 豁免是否必要？\n   □ 豁免原因是否清晰？\n   □ 是否有技术债务跟踪？\n   □ 是否可以优化代码避免豁免？\n\n4. 豁免监控：\n   - 统计豁免次数（通过 grep 统计 eslint-disable）\n   - 定期清理不必要的豁免\n   - 在质量报告中展示豁免趋势\n\n   示例脚本：\n   # 统计豁免次数\n   grep -r &quot;eslint-disable&quot; src/ | wc -l\n\n   # 查找无注释的豁免\n   grep -r &quot;eslint-disable-next-line$&quot; src/\n\n四、实践建议\n\n1. 80/20 原则：\n   - 80% 的价值来自 20% 的核心规则\n   - 不要追求规则的完美，避免过度规范\n   - 优先解决高频问题\n\n2. 渐进式收紧：\n   - 新项目：严格模式（Error）\n   - 老项目：先 Warn，逐步升级为 Error\n   - 团队新规则：试运行期 Warn，稳定后 Error\n\n3. 民主决策：\n   - 规则调整需团队讨论\n   - 定期回顾规则有效性\n   - 接受合理的豁免请求\n\n4. 数据驱动优化：\n   - 统计误报率高的规则（考虑关闭）\n   - 统计豁免次数多的规则（考虑调整）\n   - 统计真实发现的 Bug（证明价值）\n\n5. 文化建设：\n   - 规范是帮助而非限制\n   - 鼓励提出改进建议\n   - 豁免不是失败，是务实的选择\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br></div></div><hr><h3 id="_3-规范工具链建设" tabindex="-1"><a class="header-anchor" href="#_3-规范工具链建设" aria-hidden="true">#</a> 3. 规范工具链建设</h3><p>如何建设完整的规范工具链？编辑器集成、CI/CD 集成、自动化修复、质量报告？</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>一、编辑器集成（开发阶段）\n\n1. VSCode 配置（推荐）：\n   .vscode/settings.json（提交到代码库）：\n   {\n     // 保存时自动格式化\n     &quot;editor.formatOnSave&quot;: true,\n     &quot;editor.defaultFormatter&quot;: &quot;esbenp.prettier-vscode&quot;,\n\n     // 保存时自动修复 ESLint 错误\n     &quot;editor.codeActionsOnSave&quot;: {\n       &quot;source.fixAll.eslint&quot;: true\n     },\n\n     // ESLint 验证的文件类型\n     &quot;eslint.validate&quot;: [\n       &quot;javascript&quot;,\n       &quot;javascriptreact&quot;,\n       &quot;typescript&quot;,\n       &quot;typescriptreact&quot;\n     ],\n\n     // 禁用 VSCode 自带的 JS/TS 验证（避免重复）\n     &quot;javascript.validate.enable&quot;: false,\n     &quot;typescript.validate.enable&quot;: false,\n\n     // 配置文件关联\n     &quot;files.associations&quot;: {\n       &quot;*.css&quot;: &quot;css&quot;,\n       &quot;*.less&quot;: &quot;less&quot;\n     }\n   }\n\n   .vscode/extensions.json（推荐插件）：\n   {\n     &quot;recommendations&quot;: [\n       &quot;dbaeumer.vscode-eslint&quot;,\n       &quot;esbenp.prettier-vscode&quot;,\n       &quot;stylelint.vscode-stylelint&quot;,\n       &quot;ms-vscode.vscode-typescript-next&quot;\n     ]\n   }\n\n2. 其他编辑器：\n   - WebStorm：内置 ESLint 和 Prettier 支持\n   - Sublime Text：需安装 SublimeLinter-eslint\n   - Vim/Neovim：使用 ALE 或 coc-eslint\n\n3. 一键配置脚本：\n   scripts/setup-editor.sh：\n   #!/bin/bash\n   echo &quot;安装 VSCode 扩展...&quot;\n   code --install-extension dbaeumer.vscode-eslint\n   code --install-extension esbenp.prettier-vscode\n\n   echo &quot;安装项目依赖...&quot;\n   npm install\n\n   echo &quot;配置 Git Hooks...&quot;\n   npx husky install\n\n   echo &quot;✅ 开发环境配置完成！&quot;\n\n二、本地开发工具链\n\n1. 包管理器配置：\n   package.json：\n   {\n     &quot;scripts&quot;: {\n       // 检查类\n       &quot;lint&quot;: &quot;eslint src --ext .js,.jsx,.ts,.tsx&quot;,\n       &quot;lint:css&quot;: &quot;stylelint &#39;src/**/*.{css,less,scss}&#39;&quot;,\n       &quot;type-check&quot;: &quot;tsc --noEmit&quot;,\n       &quot;type-coverage&quot;: &quot;type-coverage --at-least 95&quot;,\n\n       // 修复类\n       &quot;lint:fix&quot;: &quot;eslint src --ext .js,.jsx,.ts,.tsx --fix&quot;,\n       &quot;lint:css:fix&quot;: &quot;stylelint &#39;src/**/*.{css,less,scss}&#39; --fix&quot;,\n       &quot;format&quot;: &quot;prettier --write &#39;src/**/*.{js,jsx,ts,tsx,css,less,json,md}&#39;&quot;,\n\n       // 组合命令\n       &quot;check&quot;: &quot;npm run lint &amp;&amp; npm run type-check &amp;&amp; npm run test&quot;,\n       &quot;fix&quot;: &quot;npm run lint:fix &amp;&amp; npm run format&quot;\n     }\n   }\n\n2. Git Hooks 配置：\n   .husky/pre-commit：\n   #!/bin/sh\n   . &quot;$(dirname &quot;$0&quot;)/_/husky.sh&quot;\n\n   npx lint-staged\n\n   .husky/commit-msg：\n   #!/bin/sh\n   . &quot;$(dirname &quot;$0&quot;)/_/husky.sh&quot;\n\n   npx commitlint --edit $1\n\n   .husky/pre-push：\n   #!/bin/sh\n   . &quot;$(dirname &quot;$0&quot;)/_/husky.sh&quot;\n\n   npm run type-check\n   npm run test\n\n   package.json：\n   {\n     &quot;lint-staged&quot;: {\n       &quot;*.{js,jsx,ts,tsx}&quot;: [\n         &quot;eslint --fix&quot;,\n         &quot;prettier --write&quot;\n       ],\n       &quot;*.{css,less,scss}&quot;: [\n         &quot;stylelint --fix&quot;,\n         &quot;prettier --write&quot;\n       ],\n       &quot;*.{json,md}&quot;: [\n         &quot;prettier --write&quot;\n       ]\n     }\n   }\n\n三、CI/CD 集成（持续集成）\n\n1. GitLab CI 配置：\n   .gitlab-ci.yml：\n   stages:\n     - install\n     - lint\n     - test\n     - build\n     - deploy\n\n   # 安装依赖（使用缓存加速）\n   install:\n     stage: install\n     script:\n       - npm ci\n     cache:\n       key: ${CI_COMMIT_REF_SLUG}\n       paths:\n         - node_modules/\n     artifacts:\n       paths:\n         - node_modules/\n       expire_in: 1 hour\n\n   # 代码质量检查\n   lint:\n     stage: lint\n     dependencies:\n       - install\n     script:\n       - npm run lint\n       - npm run lint:css\n     allow_failure: false  # 失败则阻止合并\n\n   # 类型检查\n   type-check:\n     stage: lint\n     dependencies:\n       - install\n     script:\n       - npm run type-check\n       - npm run type-coverage\n     artifacts:\n       reports:\n         coverage_report:\n           coverage_format: cobertura\n           path: coverage/type-coverage.xml\n\n   # 单元测试\n   test:\n     stage: test\n     dependencies:\n       - install\n     script:\n       - npm run test:coverage\n     coverage: &#39;/Statements\\s*:\\s*(\\d+\\.\\d+)%/&#39;\n     artifacts:\n       reports:\n         coverage_report:\n           coverage_format: cobertura\n           path: coverage/cobertura-coverage.xml\n       paths:\n         - coverage/\n\n   # 代码质量报告（SonarQube）\n   sonar:\n     stage: lint\n     dependencies:\n       - test\n     script:\n       - sonar-scanner\n     only:\n       - main\n       - develop\n\n2. GitHub Actions 配置：\n   .github/workflows/ci.yml：\n   name: CI\n\n   on:\n     push:\n       branches: [main, develop]\n     pull_request:\n       branches: [main, develop]\n\n   jobs:\n     lint:\n       runs-on: ubuntu-latest\n       steps:\n         - uses: actions/checkout@v3\n         - uses: actions/setup-node@v3\n           with:\n             node-version: &#39;18&#39;\n             cache: &#39;npm&#39;\n\n         - name: Install dependencies\n           run: npm ci\n\n         - name: Run ESLint\n           run: npm run lint\n\n         - name: Run StyleLint\n           run: npm run lint:css\n\n         - name: Type Check\n           run: npm run type-check\n\n         - name: Type Coverage\n           run: npm run type-coverage\n\n         - name: Run Tests\n           run: npm run test:coverage\n\n         - name: Upload coverage to Codecov\n           uses: codecov/codecov-action@v3\n           with:\n             files: ./coverage/coverage-final.json\n\n3. 合并请求检查：\n   - 设置 MR/PR 必须通过 CI 才能合并\n   - 代码质量评分低于阈值则阻止合并\n   - 类型覆盖率下降则发出警告\n\n四、自动化修复\n\n1. 本地自动修复：\n   - 保存时自动修复（编辑器集成）\n   - 提交时自动修复（lint-staged）\n   - 手动执行：npm run fix\n\n2. CI 自动修复（可选）：\n   .gitlab-ci.yml：\n   auto-fix:\n     stage: lint\n     script:\n       - npm run lint:fix\n       - npm run format\n       - |\n         if [[ `git status --porcelain` ]]; then\n           git config user.email &quot;bot@company.com&quot;\n           git config user.name &quot;Lint Bot&quot;\n           git add .\n           git commit -m &quot;chore: auto fix lint errors [skip ci]&quot;\n           git push origin HEAD:${CI_COMMIT_REF_NAME}\n         fi\n     only:\n       - merge_requests\n     when: manual  # 手动触发\n\n3. IDE 插件自动修复：\n   - VSCode：Cmd+Shift+P → &quot;ESLint: Fix all auto-fixable Problems&quot;\n   - WebStorm：Cmd+Alt+L（格式化）\n\n五、质量报告\n\n1. SonarQube 集成：\n   sonar-project.properties：\n   sonar.projectKey=my-project\n   sonar.sources=src\n   sonar.tests=src\n   sonar.test.inclusions=**/*.spec.ts,**/*.test.ts\n   sonar.javascript.lcov.reportPaths=coverage/lcov.info\n   sonar.eslint.reportPaths=eslint-report.json\n\n   生成 ESLint 报告：\n   npx eslint src --format json --output-file eslint-report.json\n\n2. 质量门禁（Quality Gate）：\n   - 代码覆盖率 &gt; 80%\n   - 类型覆盖率 &gt; 95%\n   - 重复代码率 &lt; 3%\n   - 代码复杂度 &lt; 15\n   - 新增技术债务 = 0\n\n3. 自定义质量报告：\n   scripts/quality-report.js：\n   const fs = require(&#39;fs&#39;)\n   const { ESLint } = require(&#39;eslint&#39;)\n\n   async function generateReport() {\n     const eslint = new ESLint()\n     const results = await eslint.lintFiles([&#39;src/**/*.{js,ts,jsx,tsx}&#39;])\n\n     const totalErrors = results.reduce((sum, r) =&gt; sum + r.errorCount, 0)\n     const totalWarnings = results.reduce((sum, r) =&gt; sum + r.warningCount, 0)\n\n     const report = {\n       timestamp: new Date().toISOString(),\n       errors: totalErrors,\n       warnings: totalWarnings,\n       files: results.length\n     }\n\n     fs.writeFileSync(&#39;quality-report.json&#39;, JSON.stringify(report, null, 2))\n     console.log(`✅ 质量报告已生成：${totalErrors} errors, ${totalWarnings} warnings`)\n   }\n\n   generateReport()\n\n4. 可视化报告：\n   - ESLint HTML Reporter：\n     npx eslint src -f html -o eslint-report.html\n\n   - 类型覆盖率报告：\n     npx type-coverage --detail --output-dir type-coverage-report\n\n5. 团队仪表盘：\n   - 展示每日质量趋势（错误数、覆盖率）\n   - 展示团队成员贡献（提交质量评分）\n   - 展示 Top10 问题（高频错误、重复代码）\n\n六、完整工具链架构\n\n开发阶段：\n├─ 编辑器插件（实时提示）\n├─ 保存时修复（快速反馈）\n└─ Git Hooks（提交前检查）\n\n提交阶段：\n├─ pre-commit（lint-staged）\n├─ commit-msg（commitlint）\n└─ pre-push（type-check + test）\n\nCI/CD 阶段：\n├─ ESLint 检查（阻止合并）\n├─ 类型检查（阻止合并）\n├─ 单元测试（阻止合并）\n├─ SonarQube 扫描（质量门禁）\n└─ 质量报告生成\n\n持续监控：\n├─ 质量趋势分析\n├─ 技术债务跟踪\n└─ 团队质量评分\n\n七、实施建议\n\n1. 分阶段推进：\n   - 第一周：编辑器集成 + Git Hooks\n   - 第二周：CI/CD 集成\n   - 第三周：质量报告 + SonarQube\n   - 第四周：监控优化\n\n2. 性能优化：\n   - 使用 ESLint 缓存：--cache --cache-location .eslintcache\n   - 使用 TypeScript 增量编译：--incremental\n   - CI 缓存 node_modules\n\n3. 开发体验：\n   - 快速反馈（&lt; 5秒）\n   - 友好的错误提示\n   - 一键修复\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br><span class="line-number">296</span><br><span class="line-number">297</span><br><span class="line-number">298</span><br><span class="line-number">299</span><br><span class="line-number">300</span><br><span class="line-number">301</span><br><span class="line-number">302</span><br><span class="line-number">303</span><br><span class="line-number">304</span><br><span class="line-number">305</span><br><span class="line-number">306</span><br><span class="line-number">307</span><br><span class="line-number">308</span><br><span class="line-number">309</span><br><span class="line-number">310</span><br><span class="line-number">311</span><br><span class="line-number">312</span><br><span class="line-number">313</span><br><span class="line-number">314</span><br><span class="line-number">315</span><br><span class="line-number">316</span><br><span class="line-number">317</span><br><span class="line-number">318</span><br><span class="line-number">319</span><br><span class="line-number">320</span><br><span class="line-number">321</span><br><span class="line-number">322</span><br><span class="line-number">323</span><br><span class="line-number">324</span><br><span class="line-number">325</span><br><span class="line-number">326</span><br><span class="line-number">327</span><br><span class="line-number">328</span><br><span class="line-number">329</span><br><span class="line-number">330</span><br><span class="line-number">331</span><br><span class="line-number">332</span><br><span class="line-number">333</span><br><span class="line-number">334</span><br><span class="line-number">335</span><br><span class="line-number">336</span><br><span class="line-number">337</span><br><span class="line-number">338</span><br><span class="line-number">339</span><br><span class="line-number">340</span><br><span class="line-number">341</span><br><span class="line-number">342</span><br><span class="line-number">343</span><br><span class="line-number">344</span><br><span class="line-number">345</span><br><span class="line-number">346</span><br><span class="line-number">347</span><br><span class="line-number">348</span><br><span class="line-number">349</span><br><span class="line-number">350</span><br><span class="line-number">351</span><br><span class="line-number">352</span><br><span class="line-number">353</span><br><span class="line-number">354</span><br><span class="line-number">355</span><br><span class="line-number">356</span><br><span class="line-number">357</span><br><span class="line-number">358</span><br><span class="line-number">359</span><br><span class="line-number">360</span><br><span class="line-number">361</span><br><span class="line-number">362</span><br><span class="line-number">363</span><br><span class="line-number">364</span><br><span class="line-number">365</span><br><span class="line-number">366</span><br><span class="line-number">367</span><br><span class="line-number">368</span><br><span class="line-number">369</span><br><span class="line-number">370</span><br><span class="line-number">371</span><br><span class="line-number">372</span><br><span class="line-number">373</span><br><span class="line-number">374</span><br><span class="line-number">375</span><br><span class="line-number">376</span><br></div></div><hr><h3 id="_4-规范实践经验" tabindex="-1"><a class="header-anchor" href="#_4-规范实践经验" aria-hidden="true">#</a> 4. 规范实践经验</h3><p>讲一个你推动代码规范落地的经验：遇到的阻力、如何说服团队、最终效果如何？</p><p><strong>【作答】：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>项目背景：\n- 团队规模：15 人前端团队（3 个业务组）\n- 项目现状：5 个 React 项目，代码风格不统一，Code Review 经常争论格式问题\n- 痛点：\n  · 每次 MR 有 30% 的评论是关于代码格式的\n  · 新人不知道该遵循什么规范\n  · 存在大量隐藏 Bug（如未使用的变量、==误用、类型断言滥用）\n  · TypeScript 项目 any 使用率高达 40%\n\n第一阶段：问题调研与方案设计（2 周）\n\n1. 数据收集：\n   - 统计 100 个 MR 的评论，发现 30% 是格式争议，20% 是命名争议\n   - 统计线上 Bug，发现 15% 是可以被 ESLint 发现的（如 ==、未定义变量）\n   - 调研团队成员：80% 的人支持引入规范，但担心改造成本\n\n2. 方案设计：\n   - **技术选型**：\n     · 核心：@umijs/fabric（团队主要使用 Umi + Ant Design）\n     · 理由：蚂蚁官方维护，开箱即用，包含 ESLint + Prettier + Stylelint\n     · 备选方案（非 Umi 项目）：eslint-config-airbnb-typescript\n\n   - **规则策略**（80/20 原则）：\n     · 80%：直接使用 @umijs/fabric 标准配置（零争议）\n     · 20%：团队定制（仅调整 5 条规则）\n       - no-console: 开发环境 warn，生产环境 error\n       - max-lines: 500（默认 300 太严格）\n       - complexity: warn（降级为警告）\n       - @typescript-eslint/no-unused-vars: 允许下划线开头\n       - import/prefer-default-export: off（团队偏好命名导出）\n\n   - **推进策略**：新项目先行 → 存量项目渐进式\n\n   - **成功指标**：\n     · MR 格式评论减少 80%\n     · 类型覆盖率 &gt; 90%\n     · ESLint 发现的潜在 Bug 数量\n\n3. 试点项目：\n   - 选择 1 个新项目进行试点（用户中心项目）\n\n   - **一键配置脚本**（5 分钟完成）：\n     # 安装依赖\n     npm install -D @umijs/fabric husky lint-staged @commitlint/cli @commitlint/config-conventional\n\n     # 初始化 husky\n     npx husky install\n     npm pkg set scripts.prepare=&quot;husky install&quot;\n\n     # 创建配置文件\n     echo &quot;module.exports = { extends: [require.resolve(&#39;@umijs/fabric/dist/eslint&#39;)] };&quot; &gt; .eslintrc.js\n     echo &quot;module.exports = require(&#39;@umijs/fabric&#39;).prettier;&quot; &gt; .prettierrc.js\n     echo &quot;module.exports = { extends: [&#39;@commitlint/config-conventional&#39;] };&quot; &gt; commitlint.config.js\n\n     # 配置 Git Hooks\n     npx husky add .husky/pre-commit &quot;npx lint-staged&quot;\n     npx husky add .husky/commit-msg &quot;npx commitlint --edit $1&quot;\n\n   - **package.json 配置**：\n     {\n       &quot;scripts&quot;: {\n         &quot;lint&quot;: &quot;eslint src --ext .js,.jsx,.ts,.tsx&quot;,\n         &quot;lint:fix&quot;: &quot;npm run lint -- --fix&quot;,\n         &quot;format&quot;: &quot;prettier --write \\&quot;src/**/*.{js,jsx,ts,tsx,css,less,json,md}\\&quot;&quot;\n       },\n       &quot;lint-staged&quot;: {\n         &quot;*.{js,jsx,ts,tsx}&quot;: [&quot;eslint --fix&quot;, &quot;prettier --write&quot;],\n         &quot;*.{css,less}&quot;: [&quot;stylelint --fix&quot;, &quot;prettier --write&quot;]\n       }\n     }\n\n   - 运行 2 周，收集反馈\n   - **关键成果**：团队反馈&quot;配置太简单了，比想象中容易&quot;\n\n第二阶段：遇到的阻力\n\n1. 阻力 1：&quot;影响开发效率&quot;\n   - 表现：开发抱怨每次提交都要等 lint 检查\n   - 本质：工具配置不当，检查速度慢（全量检查耗时 30 秒）\n\n   解决方案：\n   ✅ 使用 lint-staged 只检查修改文件（耗时降至 3 秒）\n   ✅ 启用 ESLint 缓存：--cache\n   ✅ 编辑器集成，保存时自动修复（无感知）\n\n   效果：\n   - 提交前检查时间从 30 秒降至 3 秒\n   - 90% 的问题在编辑器中自动修复，无需等到提交\n\n2. 阻力 2：&quot;存量代码改造成本太高&quot;\n   - 表现：运行 lint 后，发现 5000+ 错误，团队觉得无法改完\n   - 本质：畏难情绪，担心改出新 Bug\n\n   解决方案：\n   ✅ 不强制改造存量代码，使用 .eslintignore 忽略\n   ✅ 制定渐进式策略：\n      - 修改文件时顺带修复 lint 错误\n      - 每周选 1 个模块集中清理\n      - 使用 --fix 自动修复 80% 的格式问题\n   ✅ 建立技术债务看板，可视化进度\n\n   效果：\n   - 3 个月内，错误数从 5000 降至 500（-90%）\n   - 每次修改文件时顺带修复，无额外成本\n   - 团队有成就感（每周看到错误数下降）\n\n3. 阻力 3：&quot;规则太严格，不合理&quot;\n   - 表现：有些规则频繁触发，开发觉得不合理\n   - 示例：\n     · max-lines: 300（文件不能超过 300 行）\n     · complexity: 10（圈复杂度不能超过 10）\n     · react-hooks/exhaustive-deps（严格依赖检查）\n\n   解决方案：\n   ✅ 组织团队讨论会，投票决定规则级别\n   ✅ 调整规则配置：\n      - max-lines: 500（放宽限制）\n      - complexity: warn（降为警告）\n      - 允许合理豁免（需注释说明）\n   ✅ 建立规则调整机制（每月回顾）\n\n   效果：\n   - 规则接受度从 60% 提升至 95%\n   - 形成团队共识，减少争议\n\n4. 阻力 4：&quot;TypeScript 严格模式太难&quot;\n   - 表现：开启 strict: true 后，类型错误 3000+\n   - 本质：历史代码类型不完善，大量 any\n\n   解决方案：\n   ✅ 渐进式收紧：\n      - 第一周：noImplicitAny: false\n      - 第二周：noImplicitAny: true，但允许显式 any\n      - 第四周：启用 @typescript-eslint/no-explicit-any: warn\n      - 第八周：升级为 error\n   ✅ 提供类型工具函数（减少重复类型定义）\n   ✅ 组织 TypeScript 培训（2 次，每次 2 小时）\n\n   效果：\n   - 类型覆盖率从 60% 提升至 92%\n   - any 使用率从 40% 降至 5%\n   - 类型错误帮助发现 20+ 潜在 Bug\n\n第三阶段：如何说服团队\n\n1. 用数据说话：\n   - 展示试点项目数据：\n     · MR 格式评论从 30% 降至 5%\n     · Code Review 时间减少 40%\n     · 发现 15 个潜在 Bug（ESLint 自动发现）\n\n   - 计算投入产出比：\n     · 初始投入：每人 2 小时配置环境\n     · 每周节省：每人 2 小时 CR 时间\n     · ROI：第二周就回本\n\n2. 降低迁移成本：\n   - **强调使用标准配置的优势**：\n     · &quot;我们使用的是蚂蚁/Airbnb 的标准配置，不是我随便定的&quot;\n     · &quot;80% 的规则都是业界最佳实践，只定制了 5 条&quot;\n     · &quot;其他大厂也在用，这是站在巨人的肩膀上&quot;\n     · &quot;你去面试也能加分，因为很多公司都用这套规范&quot;\n\n   - 提供一键配置脚本（setup.sh）：\n     #!/bin/bash\n     # 一键安装 @umijs/fabric 全家桶\n     npm install -D @umijs/fabric\n     npx @umijs/fabric setup  # 自动生成配置文件\n\n   - 录制视频教程（10 分钟快速上手）\n   - 提供模板项目（clone 即用）\n   - 安排专人答疑（Slack 频道）\n\n3. 树立标杆：\n   - 选择影响力强的开发者先使用\n   - 在团队会议上分享正面反馈\n   - 展示自动修复的便利性（Live Demo）\n\n4. 强调长期价值：\n   - 新人融入更快（明确的规范）\n   - 代码质量提升（减少低级错误）\n   - 团队协作更顺畅（减少争议）\n   - 技术品牌提升（专业的工程化）\n\n第四阶段：全面推广（1 个月）\n\n1. 推广策略：\n   - Week 1：2 个项目试点\n   - Week 2：新项目强制使用\n   - Week 3：存量项目接入（5 个）\n   - Week 4：全员使用，CI 强制检查\n\n2. 配套措施：\n   - 建立答疑群（每日解答问题）\n   - 每周发布质量周报（排行榜）\n   - 奖励执行好的成员（月度之星）\n   - 持续优化规则（收集反馈）\n\n最终效果（3 个月后）\n\n定量效果：\n✅ MR 格式评论占比：30% → 3%（-90%）\n✅ Code Review 时间：平均 45 分钟 → 25 分钟（-44%）\n✅ 类型覆盖率：60% → 92%（+32%）\n✅ ESLint 发现潜在 Bug：累计 50+ 个\n✅ 代码格式统一率：100%（Prettier 自动格式化）\n✅ 提交信息规范率：从 40% → 95%（commitlint）\n\n定性效果：\n✅ 团队协作更顺畅（减少争议）\n✅ 新人上手更快（明确的规范）\n✅ 代码质量提升（更少 Bug）\n✅ 技术氛围更好（工程化意识提升）\n✅ 招聘加分（展示团队专业度）\n\n团队反馈：\n- 前端 Leader：&quot;Code Review 效率提升明显，可以更关注业务逻辑&quot;\n- 资深开发：&quot;一开始觉得麻烦，现在离不开了&quot;\n- 新人：&quot;规范让我快速了解团队标准，很有帮助&quot;\n\n意外收获：\n🎉 推动了单元测试覆盖率提升（从 30% → 60%）\n🎉 建立了 Monorepo 共享配置（@company/eslint-config）\n   - 基于 @umijs/fabric 封装公司级配置\n   - 内部 10+ 项目复用，配置成本接近零\n   - 新项目只需：npm install -D @company/eslint-config\n🎉 输出了团队工程化博客（外部影响力提升）\n   - &quot;为什么我们选择 @umijs/fabric 而不是 Airbnb&quot;\n   - 吸引了外部优秀人才（&quot;你们团队很专业&quot;）\n🎉 促进了前端技术委员会成立（跨团队规范统一）\n   - 推动公司级前端规范制定\n   - 其他团队也采用相同的标准配置\n   - 跨团队协作成本大幅降低\n\n关键成功因素总结：\n\n1. 渐进式推进：不追求一步到位，降低阻力\n2. 数据驱动：用数据证明价值，而非强制推行\n3. 工具化：自动化工具降低执行成本\n4. 团队共识：民主决策，而非一言堂\n5. 持续优化：定期回顾，不断改进\n\n反思与改进：\n\n不足之处：\n- 初期工具配置复杂，应提供更傻瓜化的配置\n- 缺少培训，导致部分开发者不理解规则意义\n- 监控不足，未能及时发现规则问题\n\n改进措施：\n- 开发 CLI 工具：npx @company/init（一键初始化）\n- 建立培训体系：新人必修课\n- 建立反馈机制：每月规则回顾会\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br></div></div><hr><h2 id="补充-如何封装公司级-eslint-配置" tabindex="-1"><a class="header-anchor" href="#补充-如何封装公司级-eslint-配置" aria-hidden="true">#</a> 补充：如何封装公司级 ESLint 配置</h2><h3 id="为什么需要封装公司级配置" tabindex="-1"><a class="header-anchor" href="#为什么需要封装公司级配置" aria-hidden="true">#</a> 为什么需要封装公司级配置？</h3><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>场景：\n- 公司有 10+ 个前端项目\n- 每个项目都要配置一遍 ESLint\n- 团队定制的规则分散在各个项目中\n- 规则更新时需要逐个项目修改\n\n问题：\n❌ 配置重复，维护成本高\n❌ 规则不一致，难以统一\n❌ 新项目配置门槛高\n❌ 规则升级困难\n\n解决方案：\n✅ 封装公司级 ESLint 配置包\n✅ 基于 @umijs/fabric 或 Airbnb 二次封装\n✅ 统一管理团队定制规则\n✅ 一行代码接入，零配置成本\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="实战-封装-company-eslint-config" tabindex="-1"><a class="header-anchor" href="#实战-封装-company-eslint-config" aria-hidden="true">#</a> 实战：封装 @company/eslint-config</h3><p><strong>1. 创建配置包项目：</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 初始化项目</span>\n<span class="token function">mkdir</span> eslint-config-company\n<span class="token builtin class-name">cd</span> eslint-config-company\n<span class="token function">npm</span> init -y\n\n<span class="token comment"># 安装依赖（基于 @umijs/fabric）</span>\n<span class="token function">npm</span> <span class="token function">install</span> @umijs/fabric eslint prettier stylelint\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>2. 目录结构：</strong></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>eslint-config-company/\n├── package.json\n├── index.js              # ESLint 配置入口\n├── prettier.js           # Prettier 配置\n├── stylelint.js          # Stylelint 配置\n├── typescript.js         # TypeScript 专项配置\n├── react.js              # React 专项配置\n└── README.md\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>3. 编写配置（index.js）：</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 继承标准配置（80%）</span>\n  <span class="token keyword">extends</span><span class="token operator">:</span> <span class="token punctuation">[</span>require<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;@umijs/fabric/dist/eslint&#39;</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n  <span class="token comment">// 公司级定制规则（20%）</span>\n  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token comment">// 1. 生产环境禁止 console</span>\n    <span class="token string-property property">&#39;no-console&#39;</span><span class="token operator">:</span> process__<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">&#39;production&#39;</span> <span class="token operator">?</span> <span class="token string">&#39;error&#39;</span> <span class="token operator">:</span> <span class="token string">&#39;warn&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 2. 允许下划线开头的未使用变量</span>\n    <span class="token string-property property">&#39;@typescript-eslint/no-unused-vars&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span>\n        <span class="token literal-property property">argsIgnorePattern</span><span class="token operator">:</span> <span class="token string">&#39;^_&#39;</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">varsIgnorePattern</span><span class="token operator">:</span> <span class="token string">&#39;^_&#39;</span><span class="token punctuation">,</span>\n        <span class="token literal-property property">destructuredArrayIgnorePattern</span><span class="token operator">:</span> <span class="token string">&#39;^_&#39;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 3. 文件长度限制（放宽）</span>\n    <span class="token string-property property">&#39;max-lines&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&#39;warn&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span> <span class="token literal-property property">max</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token literal-property property">skipBlankLines</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">skipComments</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 4. 圈复杂度（降级为警告）</span>\n    <span class="token literal-property property">complexity</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;warn&#39;</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 5. 允许命名导出</span>\n    <span class="token string-property property">&#39;import/prefer-default-export&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 6. React 17+ 不需要导入 React</span>\n    <span class="token string-property property">&#39;react/react-in-jsx-scope&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 7. 允许 JSX 在 tsx 文件中</span>\n    <span class="token string-property property">&#39;react/jsx-filename-extension&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">extensions</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;.tsx&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.jsx&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n    <span class="token comment">// 8. 公司特殊规则：禁止使用特定库</span>\n    <span class="token string-property property">&#39;no-restricted-imports&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span>\n        <span class="token literal-property property">paths</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n          <span class="token punctuation">{</span>\n            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;moment&#39;</span><span class="token punctuation">,</span>\n            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;请使用 dayjs 替代 moment，体积更小&#39;</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\n  <span class="token comment">// 特殊目录配置</span>\n  <span class="token literal-property property">overrides</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n      <span class="token comment">// 测试文件宽松规则</span>\n      <span class="token literal-property property">files</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;**/*.test.ts&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;**/*.test.tsx&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;**/*.spec.ts&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;**/*.spec.tsx&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&#39;@typescript-eslint/no-explicit-any&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&#39;max-lines&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&#39;no-console&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span><span class="token punctuation">,</span>\n    <span class="token punctuation">{</span>\n      <span class="token comment">// 配置文件宽松规则</span>\n      <span class="token literal-property property">files</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;*.config.js&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;*.config.ts&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;.*.js&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n      <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&#39;@typescript-eslint/no-var-requires&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&#39;import/no-commonjs&#39;</span><span class="token operator">:</span> <span class="token string">&#39;off&#39;</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><p><strong>4. Prettier 配置（prettier.js）：</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> fabric <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@umijs/fabric&#39;</span><span class="token punctuation">)</span>\n\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token operator">...</span>fabric<span class="token punctuation">.</span>prettier<span class="token punctuation">,</span>\n\n  <span class="token comment">// 公司定制</span>\n  <span class="token literal-property property">printWidth</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 行宽 100</span>\n  <span class="token literal-property property">singleQuote</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 单引号</span>\n  <span class="token literal-property property">trailingComma</span><span class="token operator">:</span> <span class="token string">&#39;es5&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 尾随逗号</span>\n  <span class="token literal-property property">tabWidth</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token comment">// 缩进 2 空格</span>\n  <span class="token literal-property property">semi</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 分号</span>\n  <span class="token literal-property property">arrowParens</span><span class="token operator">:</span> <span class="token string">&#39;always&#39;</span> <span class="token comment">// 箭头函数参数括号</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>5. package.json 配置：</strong></p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>\n  <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@company/eslint-config&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;version&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1.0.0&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;description&quot;</span><span class="token operator">:</span> <span class="token string">&quot;公司前端 ESLint 配置&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;main&quot;</span><span class="token operator">:</span> <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;files&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token string">&quot;index.js&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;prettier.js&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;stylelint.js&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;typescript.js&quot;</span><span class="token punctuation">,</span>\n    <span class="token string">&quot;react.js&quot;</span>\n  <span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;peerDependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^8.0.0&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.0&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;typescript&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^5.0.0&quot;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;dependencies&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token property">&quot;@umijs/fabric&quot;</span><span class="token operator">:</span> <span class="token string">&quot;^3.0.0&quot;</span>\n  <span class="token punctuation">}</span><span class="token punctuation">,</span>\n  <span class="token property">&quot;keywords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;eslint&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;eslintconfig&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;prettier&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;company&quot;</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p><strong>6. 项目中使用（只需一行）：</strong></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 安装</span>\n<span class="token function">npm</span> <span class="token function">install</span> -D @company/eslint-config\n\n<span class="token comment"># .eslintrc.js（只需一行！）</span>\nmodule.exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  extends: <span class="token punctuation">[</span><span class="token string">&#39;@company&#39;</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token comment"># .prettierrc.js（只需一行！）</span>\nmodule.exports <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">&#39;@company/eslint-config/prettier&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="收益分析" tabindex="-1"><a class="header-anchor" href="#收益分析" aria-hidden="true">#</a> 收益分析</h3><p><strong>配置前（每个项目单独配置）：</strong></p><ul><li>新项目配置时间：2 小时</li><li>规则维护成本：每个项目单独修改</li><li>规则一致性：差（各项目规则不统一）</li></ul><p><strong>配置后（使用 @company/eslint-config）：</strong></p><ul><li>新项目配置时间：5 分钟（-95%）</li><li>规则维护成本：修改一次，全部项目受益</li><li>规则一致性：完全统一</li></ul><p><strong>投入产出比：</strong></p><ul><li>初始投入：1 人天（封装配置包）</li><li>每个项目节省：1.9 小时</li><li>10 个项目即可回本</li><li>长期收益：规则统一、维护简单</li></ul><hr>',106),p={},r=(0,a(3744).Z)(p,[["render",function(n,s){return e}]])}}]);