"use strict";(self.webpackChunkmd_vuepress=self.webpackChunkmd_vuepress||[]).push([[4686],{5869:(l,a,n)=>{n.r(a),n.d(a,{data:()=>e});const e={key:"v-f850f4b0",path:"/interview-prep/project__dji-user-center.html",title:"大疆用户中心重构",lang:"zh-CN",frontmatter:{id:"project__dji-user-center",type:"project",title:"大疆用户中心重构",mastery:"not_started",tags:["performance","vue3","vite"],projects:["project__dji-user-center"],source_refs:[{source:"resume",file:"docs/job-description/web前端开发工程师-彭聪.md",anchor:"大疆用户中心重构"}],seed_refs:[{source:"outline",file:"docs/job-description/web前端开发工程师-彭聪-面试技术大纲.md",anchor:"1）大疆用户中心重构：性能优化 + HTTP 原理 + Webpack 架构"}],updated_at:"2025-12-20T00:00:00.000Z"},excerpt:"",headers:[{level:2,title:"摘要（Auto）",slug:"摘要-auto",children:[]},{level:2,title:"建议追问（Auto）",slug:"建议追问-auto",children:[]},{level:2,title:"关联卡片",slug:"关联卡片",children:[]},{level:2,title:"在我项目中的角色与使用场景",slug:"在我项目中的角色与使用场景",children:[]},{level:2,title:"原理简述",slug:"原理简述",children:[]},{level:2,title:"对比表格",slug:"对比表格",children:[]},{level:2,title:"模拟问答",slug:"模拟问答",children:[]},{level:2,title:"手写代码区",slug:"手写代码区",children:[]},{level:2,title:"我的补充（Manual）",slug:"我的补充-manual",children:[]},{level:2,title:"复盘与反思（Learnings）",slug:"复盘与反思-learnings",children:[]},{level:2,title:"面试官追问（面试官视角）",slug:"面试官追问-面试官视角",children:[]}],git:{updatedTime:1770275296e3},filePathRelative:"interview-prep/project__dji-user-center.md"}},6806:(l,a,n)=>{n.r(a),n.d(a,{default:()=>h});var e=n(6252);const t=(0,e.uE)('<h2 id="摘要-auto" tabindex="-1"><a class="header-anchor" href="#摘要-auto" aria-hidden="true">#</a> 摘要（Auto）</h2><ul><li>生成时间：2025-12-20</li><li>简历中出现的项目标题（提取）：大疆用户中心重构 / 大疆售后 RMS 系统重构 / 跨平台公告插件系统 / 大疆 DevOps 平台维护 / XDR 系统 - 魔方大屏 + 报表</li><li>面试大纲关键词（提取 Top10）：1）大疆用户中心重构：性能优化 + HTTP 原理 + Webpack 架构 / 性能指标与方法论 / 简历可落地点（结合你的“优化四板斧”） / HTTP 常考点（从“为什么变快”倒推） / Webpack 架构（工程化面试常考） / 按优化顺序，把方案“串起来”（排查 → 定位 → 选择 → 验证） / 0. 排查与基线（先把问题“量化”） / 1. 先保“可见”——骨架屏预渲染（直接拉低 LCP） / 2. 再减“阻塞”——关键渲染路径（CRP）梳理：CSS/字体/首图优先级 / 3. 再降“下载与解析成本”——更小的包体与更少的无效代码</li></ul><h2 id="建议追问-auto" tabindex="-1"><a class="header-anchor" href="#建议追问-auto" aria-hidden="true">#</a> 建议追问（Auto）</h2><ul><li>你为什么在该项目/场景里选择这个方案？替代方案为何不选？</li><li>最大一次事故/踩坑是什么？如何定位与回滚？</li><li>如果重做：架构/边界/工程化会怎么调整？</li></ul><h2 id="关联卡片" tabindex="-1"><a class="header-anchor" href="#关联卡片" aria-hidden="true">#</a> 关联卡片</h2>',5),s=(0,e.Uk)("技术： "),i=(0,e._)("code",null,"tech__performance",-1),o=(0,e._)("code",null,"tech__vite",-1),p=(0,e._)("code",null,"tech__webpack",-1),u=(0,e.Uk)("对比： "),r=(0,e._)("code",null,"matrix__bundler-webpack-vite-rollup",-1),c=(0,e.uE)('<h2 id="在我项目中的角色与使用场景" tabindex="-1"><a class="header-anchor" href="#在我项目中的角色与使用场景" aria-hidden="true">#</a> 在我项目中的角色与使用场景</h2><p>项目前端负责人。目标是统一 PC/移动端代码并进行性能攻坚，降低维护成本并提升登录转化。</p><h2 id="原理简述" tabindex="-1"><a class="header-anchor" href="#原理简述" aria-hidden="true">#</a> 原理简述</h2><p>我会用“关键渲染路径（CRP）+ 资源优先级 + 传输层 + 包体积”把“为什么变快”讲清楚：</p><ul><li>Context： <ul><li>用户中心属于高频访问入口，首屏体感和转化强相关；同时存在 PC/移动多端共存导致的维护成本问题。</li></ul></li><li>Problem（典型瓶颈拆解）： <ul><li>首屏关键资源被阻塞（CSS/字体/首图优先级不合理）。</li><li>首屏 bundle 过大，解析/执行占用主线程，影响 LCP/INP。</li><li>骨架/占位策略不一致导致 CLS（页面跳动）。</li></ul></li><li>Solution（按“优化四板斧”组织，面试很好讲）： <ul><li><strong>先量化</strong>：RUM 上报（LCP/INP/CLS）、关键路由分布、弱网/低端机回归矩阵。</li><li><strong>先保可见</strong>：骨架屏/占位与渐进渲染，把 LCP 拉下来。</li><li><strong>再减阻塞</strong>：CRP 梳理（关键 CSS、字体策略、首图 preload）。</li><li><strong>再降成本</strong>：路由级拆包、依赖瘦身、减少无效渲染与长任务。</li><li><strong>再做治理</strong>：性能预算 + CI 门禁 + 上线后趋势监控与告警。</li></ul></li><li>Outcome： <ul><li>不硬报数字，用“指标口径 + 验证方式”说明（例如 LCP p75、INP p75 的下降趋势）。</li></ul></li></ul><h2 id="对比表格" tabindex="-1"><a class="header-anchor" href="#对比表格" aria-hidden="true">#</a> 对比表格</h2><table><thead><tr><th>决策点</th><th>方案 A</th><th>方案 B</th><th>方案 C</th><th>我怎么选（口径）</th></tr></thead><tbody><tr><td>构建体系</td><td>Webpack 存量优化</td><td>Vite 全量迁移</td><td>双构建并行</td><td>存量项目优先“先稳后快”：旁路验证，逐模块迁移</td></tr><tr><td>骨架屏</td><td>纯前端渲染</td><td>服务端直出</td><td>预生成静态骨架</td><td>首屏关键页面可用“预生成/直出”降低 LCP，保证尺寸一致避免 CLS</td></tr><tr><td>资源优先级</td><td>默认加载</td><td>preload 关键资源</td><td>prefetch 下一跳</td><td>关键资源 preload（首图/关键 chunk/字体），prefetch 用于路由热度</td></tr></tbody></table><h2 id="模拟问答" tabindex="-1"><a class="header-anchor" href="#模拟问答" aria-hidden="true">#</a> 模拟问答</h2><p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; Current (Your changes)</p><ul><li>[ ] Q1：为什么骨架屏能显著改善 LCP？如何避免 CLS？ <ul><li>LCP 为什么会变好：骨架屏把“最大内容区域”更早绘制出来，减少“等 JS 执行/接口返回才出内容”的空窗期。</li><li>关键实现点（避免翻车）： <ul><li><strong>尺寸一致</strong>：骨架与真实内容共享同一布局（同宽高/同栅格），避免切换时产生 Layout Shift。</li><li><strong>CSS 优先</strong>：骨架所需关键 CSS 尽量内联或优先加载，避免“骨架也被 CSS 阻塞”。</li><li><strong>切换策略</strong>：不要“闪一下骨架就消失”，弱网/低端机可延迟切换，避免抖动。</li></ul></li><li>验证口径：LCP p75 下降 + CLS 保持稳定；用 Performance 里的 Layout Shift 事件定位抖动源。</li></ul></li><li>[ ] Q2：你的“优化四板斧”分别对应浏览器链路哪一段？怎么保证每一刀都有证据？ <ul><li>量化：RUM/Web Vitals（真实用户）+ Lighthouse（实验室）对齐口径（p50/p75/p95、设备/网络矩阵）。</li><li>定位：Network 看关键资源 waterfall；Performance 看 Long Task、主线程阻塞点；必要时看框架 Profiler。</li><li>选择：先保可见（骨架/占位）→ 再减阻塞（CRP：CSS/字体/首图）→ 再降成本（包体/执行）。</li><li>验证：每次改动绑定假设（例如“首屏 JS -200KB → LCP p75 -300ms”），上线灰度对比趋势。</li></ul></li><li>[ ] Q3：如果重做一次，你会怎么设计性能预算与回归门禁？ <ul><li>预算维度：入口/关键路由 chunk 体积上限、首屏关键资源（css/font/hero）上限、长任务阈值。</li><li>门禁落地：CI 比对产物体积（或 stats.json）、Lighthouse 关键指标阈值；超阈值阻断或需要审批。</li><li>守护策略：上线后 RUM 趋势告警（p75/p95），异常触发开关降级与回滚。</li></ul></li><li>[ ] Q4：HTTP/1.1 vs HTTP/2 vs HTTP/3，对首屏变快分别影响在哪里？ <ul><li>HTTP/1.1：多连接并发、队头阻塞明显；域名拆分有时能提并发但副作用大（DNS/握手/缓存分散）。</li><li>HTTP/2：多路复用、头部压缩（HPACK），整体更适合“少连接多请求”的现代站点；一般不推荐再做 domain sharding。</li><li>HTTP/3：基于 QUIC（UDP），减少传输层队头阻塞；在弱网/丢包环境可能更稳。</li><li>验证口径：对比关键资源总下载耗时、连接数、协议版本、以及瀑布图阻塞链是否缩短（不是只看“协议升级了”）。</li></ul></li><li>[ ] Q5：TLS 1.3 的收益点是什么？你怎么在线上确认“确实变快了”？ <ul><li>收益点：握手往返更少（RTT 更少）、会话复用更友好；配合 HTTP/2 复用收益更明显。</li><li>线上确认： <ul><li>Network 面板确认协商协议/握手耗时变化（结合不同网络环境）。</li><li>看 TTFB 与首屏关键资源的连接建立耗时分布（p75/p95），避免被缓存命中“假快”干扰。</li></ul></li></ul></li><li>[ ] Q6：缓存体系你怎么设计（强缓存/协商缓存/CDN/哈希策略/SW）？最大的坑是什么？ <ul><li>强缓存：<code>cache-control: max-age, immutable</code> 用于带 hash 的静态资源。</li><li>协商缓存：HTML/配置类资源用 ETag/Last-Modified 控制更新。</li><li>CDN：按路径与 query 设计缓存键；注意按用户/权限隔离的资源不要误缓存。</li><li>哈希策略：业务 chunk 用 <code>contenthash</code>；runtime 单独抽离避免全量失效。</li><li>Service Worker：适合离线/弱网兜底，但最大坑是“更新策略”——必须有版本切换与强制刷新方案，否则会卡旧资源。</li></ul></li><li>[ ] Q7：CRP 里最常见的阻塞是什么？你具体怎么处理（CSS/字体/首图）？ <ul><li>CSS：关键 CSS 提取/内联；非关键拆分延迟加载。</li><li>字体：子集化/压缩 + 合理 <code>font-display</code>（swap/optional），必要时 preload；避免 FOIT/FOUT 带来的体验问题。</li><li>首图：用 <code>preload</code>/<code>fetchpriority=&quot;high&quot;</code> 提升优先级，且保证尺寸合适（避免传大图缩小）。</li></ul></li><li>[ ] Q8：WebP/AVIF 怎么接入？怎么做兼容兜底与性能验证？ <ul><li>接入：优先 <code>&lt;picture&gt;</code>（avif/webp/jpg fallback）或按能力探测下发。</li><li>兜底：旧环境回退 jpg/png；同时确保预留宽高，避免 CLS。</li><li>验证：对比同一首图资源体积/下载耗时、LCP 候选资源完成时间与解码开销（Performance）。</li></ul></li><li>[ ] Q9：<code>core-js</code> 精简怎么做？常见风险是什么？ <ul><li>做法：基于 <code>browserslist</code> + <code>useBuiltIns: usage</code>/按需引入，避免全量 polyfill。</li><li><h1 id="风险-目标浏览器误配置导致线上缺-polyfill-需要-兼容性回归矩阵-监控错误-兜底。" tabindex="-1"><a class="header-anchor" href="#风险-目标浏览器误配置导致线上缺-polyfill-需要-兼容性回归矩阵-监控错误-兜底。" aria-hidden="true">#</a> 风险：目标浏览器误配置导致线上缺 polyfill；需要“兼容性回归矩阵 + 监控错误”兜底。</h1></li></ul></li><li>[ ] 为什么骨架屏能显著改善 LCP？如何避免 CLS？</li><li>[ ] 你的“优化四板斧”分别对应浏览器链路的哪一段？如何验证每一刀的收益？</li><li>[ ] 如果重做一次，你会怎么设计性能预算与回归门禁？</li><li>[ ] 从“HTTP/协议/缓存”角度，哪些点是你优化后真正在首屏链路里生效的？ <ul><li>可复述要点： <ul><li>协议：HTTP/2 复用减少连接开销，但要注意“域名拆分”在 H2 下多数没收益。</li><li>缓存：强缓存（<code>cache-control</code>）+ 协商缓存（<code>etag/last-modified</code>）+ 版本 hash 命名提升命中率。</li><li>CDN：静态资源走 CDN，关注回源率与缓存失效策略（按 hash 文件名可长缓存）。</li><li>Service Worker（如有）：能做离线与更细粒度缓存，但更新策略要谨慎（避免“缓存住 bug”）。</li></ul></li></ul></li><li>[ ] TLS 1.3 / 0-RTT 你会怎么讲？如何证明线上确实有收益？ <ul><li>可复述要点： <ul><li>TLS 1.3 减少握手轮次，弱网/高 RTT 下收益更明显；配合 HTTP/2 复用能放大整体收益。</li><li>证明方式：抓真实用户网络数据（RUM）+ 服务器日志（协议协商、握手耗时），对比 TTFB/连接建立时间分布。</li></ul></li></ul></li><li>[ ] 图片优化（WebP/AVIF/懒加载）怎么落地？如何兼容兜底？如何避免 CLS 与解码开销？ <ul><li>可复述要点： - 格式：优先 WebP/AVIF，旧环境回退 jpg/png（<code>&lt;picture&gt;</code> 或服务端按 Accept 协商）。 - 兜底：按 UA/能力探测，失败回退；同时做好缓存键区分（避免不同格式互相污染缓存）。 - CLS：固定宽高/占位；懒加载要配合占位与骨架；首图设置更高优先级。 - 解码：控制首图尺寸与压缩，避免“传大图缩小显示”。 <blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><blockquote><p>Incoming (Background Agent changes)</p></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></blockquote></li></ul></li></ul><p>补充可直接回答的要点（给你“可背诵”的版本）：</p><ul><li>为什么骨架屏改善 LCP？ <ul><li>LCP 关注“最大内容元素是否渲染完成”。骨架屏让最大元素更早出现（即便是占位），用户感知更早“有内容”。</li><li>关键：骨架要与真实内容同尺寸/同布局，否则会带来 CLS。</li></ul></li><li>四板斧对应链路： <ul><li>量化：RUM/埋点（真实用户数据）</li><li>可见：渲染策略（骨架/占位/渐进）</li><li>阻塞：CRP（CSS/字体/首图/关键 JS）</li><li>成本：包体/执行/无效渲染（拆包、依赖瘦身、memo/虚拟化）</li></ul></li><li>预算与门禁： <ul><li>预算（体积/关键资源/长任务阈值）写进 CI；</li><li>上线后看趋势（p75/p95），异常告警 + 可回滚开关。</li></ul></li></ul><h2 id="手写代码区" tabindex="-1"><a class="header-anchor" href="#手写代码区" aria-hidden="true">#</a> 手写代码区</h2><p>关键资源优先级（HTML 注入示例）：</p><div class="language-html ext-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 首图/关键字体/关键 chunk：preload --&gt;</span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span> <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/hero.webp<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fetchpriority</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>high<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>\n<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span>\n  <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>preload<span class="token punctuation">&quot;</span></span>\n  <span class="token attr-name">as</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>font<span class="token punctuation">&quot;</span></span>\n  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/assets/Inter.woff2<span class="token punctuation">&quot;</span></span>\n  <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>font/woff2<span class="token punctuation">&quot;</span></span>\n  <span class="token attr-name">crossorigin</span>\n<span class="token punctuation">/&gt;</span></span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>骨架屏切换关键逻辑（伪代码：避免 CLS 的关键是“占位尺寸一致”）：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">ViewState</span> <span class="token operator">=</span> <span class="token string">&#39;skeleton&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;real&#39;</span>\n\n<span class="token keyword">function</span> <span class="token function">shouldShowSkeleton</span><span class="token punctuation">(</span>ttfbMs<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> deviceScore<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n  <span class="token comment">// 弱网/低端机更倾向展示 skeleton，提升感知速度</span>\n  <span class="token keyword">return</span> ttfbMs <span class="token operator">&gt;</span> <span class="token number">300</span> <span class="token operator">||</span> deviceScore <span class="token operator">&lt;</span> <span class="token number">50</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="我的补充-manual" tabindex="-1"><a class="header-anchor" href="#我的补充-manual" aria-hidden="true">#</a> 我的补充（Manual）</h2><p>（不会被脚本覆盖：你真实线上观测、踩坑与回滚方案）</p><h2 id="复盘与反思-learnings" tabindex="-1"><a class="header-anchor" href="#复盘与反思-learnings" aria-hidden="true">#</a> 复盘与反思（Learnings）</h2><ul><li>如果重做会怎么改？</li></ul><h2 id="面试官追问-面试官视角" tabindex="-1"><a class="header-anchor" href="#面试官追问-面试官视角" aria-hidden="true">#</a> 面试官追问（面试官视角）</h2><ul><li>[ ] 为什么选这个方案？替代方案为什么不选？</li><li>[!] 最大一次事故/踩坑是什么？如何定位与回滚？</li><li>[ ] 如果重做会怎么改？</li><li>[ ] HTTP/1.1、HTTP/2、HTTP/3 的核心差异你怎么用“首屏优化”串起来讲？</li><li>[ ] 字体（<code>font-display</code>/子集化/预加载）怎么做？如何避免 FOIT/FOUT 与重排？</li><li>[ ] 你如何设计“回归矩阵”（机型/网络/路径）？为什么用 p75/p95 而不是平均值？</li></ul>',23),d={},h=(0,n(3744).Z)(d,[["render",function(l,a){const n=(0,e.up)("RouterLink");return(0,e.wg)(),(0,e.iD)(e.HY,null,[t,(0,e._)("ul",null,[(0,e._)("li",null,[s,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(n,{to:"/interview-prep/tech__performance.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,e.w5)((()=>[i])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(n,{to:"/interview-prep/tech__vite.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,e.w5)((()=>[o])),_:1})]),(0,e._)("li",null,[(0,e.Wm)(n,{to:"/interview-prep/tech__webpack.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,e.w5)((()=>[p])),_:1})])])]),(0,e._)("li",null,[u,(0,e._)("ul",null,[(0,e._)("li",null,[(0,e.Wm)(n,{to:"/interview-prep/matrix__bundler-webpack-vite-rollup.html#%E5%AF%B9%E6%AF%94%E8%A1%A8%E6%A0%BC"},{default:(0,e.w5)((()=>[r])),_:1})])])])]),c],64)}]])}}]);