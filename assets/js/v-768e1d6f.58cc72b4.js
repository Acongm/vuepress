"use strict";(self.webpackChunkmd_vuepress=self.webpackChunkmd_vuepress||[]).push([[1660],{5845:(n,e,s)=>{s.r(e),s.d(e,{data:()=>t});const t={key:"v-768e1d6f",path:"/interview-prep/tech__eslint-engineering.html",title:"工程化规范（ESLint/Prettier/Husky/CI 门禁）",lang:"zh-CN",frontmatter:{id:"tech__eslint-engineering",type:"tech",title:"工程化规范（ESLint/Prettier/Husky/CI 门禁）",mastery:"not_started",tags:["eslint","prettier","umi","husky","lint-staged","commitlint","cicd","engineering"],projects:["project__dji-rms","project__dji-devops"],source_refs:[{source:"outline",file:"docs/job-description/web前端开发工程师-彭聪-面试技术大纲.md",anchor:"2）Umi：ESLint 规范有哪些，以及如何整合到实践"}],updated_at:"2025-12-21T00:00:00.000Z"},excerpt:"",headers:[{level:2,title:"关联卡片",slug:"关联卡片",children:[]},{level:2,title:"在我项目中的角色与使用场景",slug:"在我项目中的角色与使用场景",children:[]},{level:2,title:"原理简述",slug:"原理简述",children:[{level:3,title:"1）分工：Prettier vs ESLint vs TypeScript",slug:"_1-分工-prettier-vs-eslint-vs-typescript",children:[]},{level:3,title:"2）闭环：让规则“真的执行”",slug:"_2-闭环-让规则-真的执行",children:[]},{level:3,title:"3）模块边界治理（高收益）",slug:"_3-模块边界治理-高收益",children:[]}]},{level:2,title:"对比表格",slug:"对比表格",children:[]},{level:2,title:"模拟问答",slug:"模拟问答",children:[]},{level:2,title:"手写代码区",slug:"手写代码区",children:[]},{level:2,title:"我的补充（Manual）",slug:"我的补充-manual",children:[]}],git:{updatedTime:1770135605e3},filePathRelative:"interview-prep/tech__eslint-engineering.md"}},803:(n,e,s)=>{s.r(e),s.d(e,{default:()=>h});var t=s(6252);const a=(0,t._)("h2",{id:"关联卡片",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#关联卡片","aria-hidden":"true"},"#"),(0,t.Uk)(" 关联卡片")],-1),l=(0,t.Uk)("项目： "),r=(0,t._)("code",null,"project__dji-rms",-1),i=(0,t._)("code",null,"project__dji-devops",-1),p=(0,t.Uk)("技术： "),o=(0,t._)("code",null,"tech__typescript",-1),c=(0,t._)("code",null,"tech__react",-1),u=(0,t.uE)('<h2 id="在我项目中的角色与使用场景" tabindex="-1"><a class="header-anchor" href="#在我项目中的角色与使用场景" aria-hidden="true">#</a> 在我项目中的角色与使用场景</h2><ul><li>典型场景：中后台多人协作、页面多、交叉开发频繁，最怕： <ul><li>风格不统一导致 Review 低效</li><li>隐性 bug（hooks/async/类型边界）线上难复现</li><li>模块乱引用导致耦合与循环依赖</li></ul></li><li>我的目标：把“人肉 Review 的底层劳动”交给工具，把团队注意力拉回到“业务正确性与架构演进”。</li></ul><h2 id="原理简述" tabindex="-1"><a class="header-anchor" href="#原理简述" aria-hidden="true">#</a> 原理简述</h2><h3 id="_1-分工-prettier-vs-eslint-vs-typescript" tabindex="-1"><a class="header-anchor" href="#_1-分工-prettier-vs-eslint-vs-typescript" aria-hidden="true">#</a> 1）分工：Prettier vs ESLint vs TypeScript</h3><ul><li>Prettier：<strong>格式化</strong>（排版/换行/空格），降低风格争议。</li><li>ESLint：<strong>语义规则与质量</strong>（潜在 bug、坏味道、边界约束、安全规则）。</li><li>TypeScript：<strong>类型正确性</strong>（契约、边界收敛、减少运行时分支与错误传播）。</li></ul><p>关键点：避免三者“打架”</p><ul><li>让 Prettier 只负责格式（通过 eslint-config-prettier 关闭与格式冲突的规则）</li><li>ESLint 聚焦语义与边界（hooks/import/no-cycle/no-eval 等）</li><li>TS 把 <code>any/unknown</code> 风险收敛在边界模块</li></ul><h3 id="_2-闭环-让规则-真的执行" tabindex="-1"><a class="header-anchor" href="#_2-闭环-让规则-真的执行" aria-hidden="true">#</a> 2）闭环：让规则“真的执行”</h3><p>我常用的执行链路（面试可直接复述）：</p><ul><li>IDE：保存自动修复（eslint --fix / prettier）</li><li>提交：husky + lint-staged（<strong>只检查改动文件</strong>，反馈快）</li><li>PR/CI：lint（<code>--max-warnings=0</code>）+ typecheck +（按项目）单测/扫描</li><li>技术债：老代码目录/文件豁免 + 技术债清单 + 分阶段收敛（warning → error）</li></ul><h3 id="_3-模块边界治理-高收益" tabindex="-1"><a class="header-anchor" href="#_3-模块边界治理-高收益" aria-hidden="true">#</a> 3）模块边界治理（高收益）</h3><p>目标：把“架构约束”写成规则，避免靠口头共识。</p><ul><li>import/order：可读性</li><li>no-restricted-imports：禁止跨层/深层路径导入，必须从模块出口导入</li><li>import/no-cycle：防循环依赖</li></ul><h2 id="对比表格" tabindex="-1"><a class="header-anchor" href="#对比表格" aria-hidden="true">#</a> 对比表格</h2><table><thead><tr><th>维度</th><th>仅靠 Code Review</th><th>仅靠 Prettier</th><th>ESLint + Prettier + CI 门禁</th></tr></thead><tbody><tr><td>一致性</td><td>低（看人）</td><td>高（格式）</td><td><strong>高（格式+语义）</strong></td></tr><tr><td>发现 bug 能力</td><td>中（依赖经验）</td><td>低</td><td><strong>高（规则覆盖）</strong></td></tr><tr><td>执行力度</td><td>低（容易妥协）</td><td>中</td><td><strong>高（流程固化）</strong></td></tr><tr><td>团队体验</td><td>Review 变“挑格式”</td><td>只解决排版</td><td>Review 回到“架构/业务”</td></tr></tbody></table><h2 id="模拟问答" tabindex="-1"><a class="header-anchor" href="#模拟问答" aria-hidden="true">#</a> 模拟问答</h2><ul><li>[ ] Q1：你定了哪些规则？为什么这些规则“收益最高”？ <ul><li>推荐回答： <ul><li>Hooks：<code>react-hooks/rules-of-hooks</code>、<code>react-hooks/exhaustive-deps</code>（避免线上难复现 bug）</li><li>TS 边界：限制 <code>any</code>（必要豁免要写理由），鼓励关键模块更严格类型</li><li>import 边界：<code>no-restricted-imports</code> + <code>import/no-cycle</code></li><li>安全质量：<code>no-eval</code>、Promise 处理（如 no-floating-promises）、no-debugger/no-console（按环境）</li></ul></li></ul></li><li>[ ] Q2：你怎么处理“本地过/CI 不过”？ <ul><li>推荐回答： <ul><li>统一 Node/TS 版本（如 .nvmrc/volta/engines），并把 CI 与本地脚本对齐</li><li>lint-staged 只跑改动文件，CI 跑全量门禁；两者规则源一致（同一份配置）</li></ul></li></ul></li><li>[ ] Q3：warning → error 的渐进策略怎么做？为什么不能一步到位 strict？ <ul><li>推荐回答： <ul><li>多团队存量大，一步到位会导致“全员被阻断”，最后规则会被撤掉</li><li>先把新增代码收紧（只允许新增不增加债），再逐步清旧债（按目录/模块收敛）</li></ul></li></ul></li><li>[ ] Q4：怎么把“模块化边界”固化到规则？举例说清楚 <ul><li>推荐回答： <ul><li>约定结构：shared/features/pages/services</li><li>用 no-restricted-imports 禁止 features/a 直接依赖 features/b，只能依赖 shared</li></ul></li></ul></li></ul><h2 id="手写代码区" tabindex="-1"><a class="header-anchor" href="#手写代码区" aria-hidden="true">#</a> 手写代码区</h2><p>一个“禁止跨层/深层路径导入”的规则思路（示意）：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// .eslintrc.cjs (snippet)</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>\n  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n    <span class="token string-property property">&#39;no-restricted-imports&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n      <span class="token string">&#39;error&#39;</span><span class="token punctuation">,</span>\n      <span class="token punctuation">{</span>\n        <span class="token literal-property property">patterns</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n          <span class="token comment">// 禁止绕过模块出口：不允许从深层路径导入</span>\n          <span class="token punctuation">{</span>\n            <span class="token literal-property property">group</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;**/features/*/*&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;**/services/*/*&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n            <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&#39;禁止深层路径导入，请从模块出口（index.ts）导入。&#39;</span>\n          <span class="token punctuation">}</span><span class="token punctuation">,</span>\n          <span class="token comment">// 禁止跨域引用（示意：features 之间不能互相 import）</span>\n          <span class="token punctuation">{</span>\n            <span class="token literal-property property">group</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;**/features/*&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n            <span class="token literal-property property">message</span><span class="token operator">:</span>\n              <span class="token string">&#39;禁止跨 feature 直接引用，请下沉到 shared 或通过服务层解耦。&#39;</span>\n          <span class="token punctuation">}</span>\n        <span class="token punctuation">]</span>\n      <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n  <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="我的补充-manual" tabindex="-1"><a class="header-anchor" href="#我的补充-manual" aria-hidden="true">#</a> 我的补充（Manual）</h2><p>（不会被脚本覆盖：真实踩坑、团队推进方式、与业务节奏的权衡）</p>',22),d={},h=(0,s(3744).Z)(d,[["render",function(n,e){const s=(0,t.up)("RouterLink");return(0,t.wg)(),(0,t.iD)(t.HY,null,[a,(0,t._)("ul",null,[(0,t._)("li",null,[l,(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(s,{to:"/interview-prep/project__dji-rms.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,t.w5)((()=>[r])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(s,{to:"/interview-prep/project__dji-devops.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,t.w5)((()=>[i])),_:1})])])]),(0,t._)("li",null,[p,(0,t._)("ul",null,[(0,t._)("li",null,[(0,t.Wm)(s,{to:"/interview-prep/tech__typescript.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,t.w5)((()=>[o])),_:1})]),(0,t._)("li",null,[(0,t.Wm)(s,{to:"/interview-prep/tech__react.html#%E5%8E%9F%E7%90%86%E7%AE%80%E8%BF%B0"},{default:(0,t.w5)((()=>[c])),_:1})])])])]),u],64)}]])}}]);