# vite - çŸ¥è¯†æ¢³ç†

ä½œä¸ºå‰ç«¯å¼€å‘è€…ï¼Œä½ å·²ç»ç†Ÿæ‚‰ Reactã€Ant Designã€Webpack ç­‰å·¥å…·ï¼Œå­¦ä¹  Vite ä¼šæ˜¯ä¸€ä¸ªé«˜æ•ˆä¸”å€¼å¾—æŠ•å…¥çš„æ–¹å‘ã€‚ä»¥ä¸‹æ˜¯å›´ç»• **Vite** çš„ç³»ç»ŸçŸ¥è¯†æ¢³ç†ï¼Œå¸®åŠ©ä½ ä»é›¶æ„å»ºè®¤çŸ¥ä½“ç³»ï¼Œå¿«é€ŸæŒæ¡å¹¶åº”ç”¨äºå®é™…é¡¹ç›®ã€‚

---

## ä¸€ã€Vite æ˜¯ä»€ä¹ˆï¼Ÿ

**Vite**ï¼ˆæ³•è¯­â€œå¿«â€ï¼‰æ˜¯ç”± Vue ä½œè€…å°¤é›¨æºªï¼ˆEvan Youï¼‰ä¸»å¯¼å¼€å‘çš„æ–°ä¸€ä»£å‰ç«¯æ„å»ºå·¥å…·ã€‚æ ¸å¿ƒç‰¹ç‚¹ï¼š

- **å¼€å‘é˜¶æ®µ**ï¼šåŸºäºåŸç”Ÿ ES æ¨¡å—ï¼ˆESMï¼‰æä¾›**æŒ‰éœ€åŠ è½½**ï¼Œå¯åŠ¨å’Œçƒ­æ›´æ–°æå¿«ï¼ˆæ¯«ç§’çº§ï¼‰ã€‚
- **ç”Ÿäº§æ„å»º**ï¼šåŸºäº **Rollup** æ‰“åŒ…ï¼Œè¾“å‡ºé«˜åº¦ä¼˜åŒ–çš„é™æ€èµ„æºã€‚
- **æ¡†æ¶æ— å…³**ï¼šåŸç”Ÿæ”¯æŒ Vueã€Reactã€Svelteã€Lit ç­‰ï¼Œå¯¹ React æ”¯æŒéå¸¸å¥½ã€‚
- **å¼€ç®±å³ç”¨**ï¼šTypeScriptã€JSXã€CSS é¢„å¤„ç†å™¨ã€JSONã€WebAssembly ç­‰æ— éœ€é…ç½®ã€‚

> âœ… å¯¹ä½ è€Œè¨€ï¼šVite æ›¿ä»£ Webpack å¼€å‘ç¯å¢ƒï¼Œå¯ä¿ç•™ Rollup ç”¨äºç”Ÿäº§æ„å»ºï¼ˆä½† Vite æœ¬èº«ä¹Ÿç”¨ Rollup æ„å»ºç”Ÿäº§åŒ…ï¼‰ã€‚

---

## äºŒã€æ ¸å¿ƒåŸç†

### 1. å¼€å‘æœåŠ¡å™¨ï¼ˆDev Serverï¼‰

- åˆ©ç”¨ç°ä»£æµè§ˆå™¨åŸç”Ÿæ”¯æŒ `<script type="module">`ã€‚
- ä¸æ‰“åŒ…æºç ï¼Œåªåš **æ¨¡å—å›¾è§£æ + æŒ‰éœ€è½¬æ¢**ï¼ˆå¦‚ TS â†’ JSã€JSX â†’ JSï¼‰ã€‚
- ä¾èµ–é¢„æ„å»ºï¼ˆ`esbuild`ï¼‰ï¼šå°† CommonJS/UMD ä¾èµ–è½¬ä¸º ESMï¼Œæå‡åŠ è½½æ€§èƒ½ã€‚

### 2. ç”Ÿäº§æ„å»ºï¼ˆBuildï¼‰

- ä½¿ç”¨ **Rollup** è¿›è¡Œ Tree-shakingã€ä»£ç åˆ†å‰²ã€å‹ç¼©ç­‰ã€‚
- é…ç½®ä¸å¼€å‘ä¸€è‡´ï¼ˆ`vite.config.ts`ï¼‰ï¼Œä½†æ’ä»¶è¡Œä¸ºå¯èƒ½ä¸åŒã€‚

---

## ä¸‰ã€æ ¸å¿ƒæ¦‚å¿µ & é…ç½®é¡¹ï¼ˆ`vite.config.ts`ï¼‰

| é…ç½®é¡¹          | è¯´æ˜         | å¸¸ç”¨å€¼                                       |
| --------------- | ------------ | -------------------------------------------- |
| `root`          | é¡¹ç›®æ ¹ç›®å½•   | é»˜è®¤ `process.cwd()`                         |
| `base`          | éƒ¨ç½²åŸºç¡€è·¯å¾„ | `"/"` æˆ– `"/my-app/"`                        |
| `resolve.alias` | è·¯å¾„åˆ«å     | `{ '@': path.resolve(__dirname, 'src') }`    |
| `define`        | å…¨å±€å¸¸é‡æ›¿æ¢ | `{ 'process.env.NODE_ENV': '"production"' }` |
| `css`           | CSS ç›¸å…³é…ç½® | `preprocessorOptions`, `modules`             |
| `build`         | ç”Ÿäº§æ„å»ºé€‰é¡¹ | `outDir`, `rollupOptions`, `minify`          |
| `server`        | å¼€å‘æœåŠ¡å™¨   | `port`, `host`, `proxy`                      |
| `plugins`       | æ’ä»¶ç³»ç»Ÿ     | å®˜æ–¹/ç¤¾åŒºæ’ä»¶ï¼ˆå¦‚ `@vitejs/plugin-react`ï¼‰   |

---

## å››ã€å¸¸ç”¨æ’ä»¶ï¼ˆä½ ä½œä¸º React + Ant Design ç”¨æˆ·é‡ç‚¹å…³æ³¨ï¼‰

| æ’ä»¶                      | ç”¨é€”                                         |
| ------------------------- | -------------------------------------------- |
| `@vitejs/plugin-react`    | æ”¯æŒ React Fast Refreshã€JSXã€HMR            |
| `vite-plugin-svgr`        | å¯¼å…¥ `.svg` ä½œä¸º React ç»„ä»¶                  |
| `unplugin-auto-import`    | è‡ªåŠ¨å¯¼å…¥ Reactã€Ant Design ç­‰ APIï¼ˆæå‡ DXï¼‰ |
| `vite-plugin-pages`       | åŸºäºæ–‡ä»¶ç³»ç»Ÿçš„è·¯ç”±ï¼ˆç±»ä¼¼ Next.jsï¼‰           |
| `vite-plugin-eslint`      | å¼€å‘æ—¶ ESLint æŠ¥é”™                           |
| `vite-plugin-compression` | ç”Ÿäº§æ„å»ºæ—¶ç”Ÿæˆ gzip/brotli å‹ç¼©æ–‡ä»¶          |

> ğŸ’¡ Ant Design æ— éœ€ç‰¹æ®Šé…ç½®ï¼Œç›´æ¥ `import { Button } from 'antd'` å³å¯ï¼Œä½†å»ºè®®é…åˆ `unplugin-auto-import` + `unplugin-vue-components`ï¼ˆè™½ç„¶åå­—å¸¦ Vueï¼Œä½†æ”¯æŒ Reactï¼‰æŒ‰éœ€å¼•å…¥ã€‚

---

## äº”ã€ä¸ Webpack å¯¹æ¯”ï¼ˆé’ˆå¯¹ä½ çš„èƒŒæ™¯ï¼‰

| èƒ½åŠ›       | Webpack                    | Vite                     |
| ---------- | -------------------------- | ------------------------ |
| å¯åŠ¨é€Ÿåº¦   | æ…¢ï¼ˆå…¨é‡æ‰“åŒ…ï¼‰             | æå¿«ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰         |
| HMR æ›´æ–°   | æ…¢ï¼ˆé‡æ„æ¨¡å—ï¼‰             | å¿«ï¼ˆç²¾å‡†æ›´æ–°ï¼‰           |
| é…ç½®å¤æ‚åº¦ | é«˜ï¼ˆloader/plugin ä½“ç³»ï¼‰   | ä½ï¼ˆå¼€ç®±å³ç”¨ï¼‰           |
| ç”Ÿäº§æ„å»º   | è‡ªèº«å®Œæˆ                   | åŸºäº Rollup              |
| ä¾èµ–å¤„ç†   | å…¨é‡æ‰“åŒ…ä¾èµ–               | é¢„æ„å»º + ESM             |
| é€‚ç”¨åœºæ™¯   | å¤§å‹å¤æ‚é¡¹ç›®ï¼ˆéœ€æ·±åº¦å®šåˆ¶ï¼‰ | ç°ä»£é¡¹ç›®ï¼ˆè¿½æ±‚å¼€å‘ä½“éªŒï¼‰ |

> âœ… ä½ ç”¨ Webpack ä¸»è¦ä¸ºäº†å¼€å‘è°ƒè¯• + æ„å»ºã€‚Vite å¯å®Œç¾æ›¿ä»£å¼€å‘é˜¶æ®µï¼Œæ„å»ºé˜¶æ®µä¹Ÿè¶³å¤Ÿæˆç†Ÿã€‚

---

## å…­ã€å­¦ä¹ è·¯å¾„å»ºè®®

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€æŒæ¡ï¼ˆ1-2 å¤©ï¼‰

1. å®‰è£…å¹¶åˆ›å»ºä¸€ä¸ª React é¡¹ç›®ï¼š
   ```bash
   npm create vite@latest my-react-app -- --template react-ts
   ```
2. ç†Ÿæ‚‰ `vite.config.ts` åŸºç¡€é…ç½®ã€‚
3. ä½“éªŒå¼€å‘æœåŠ¡å™¨é€Ÿåº¦ vs Webpackã€‚

### ç¬¬äºŒé˜¶æ®µï¼šé›†æˆå®é™…éœ€æ±‚ï¼ˆ2-3 å¤©ï¼‰

- é…ç½® Ant Design æŒ‰éœ€åŠ è½½ï¼ˆé€šè¿‡ `unplugin-auto-import`ï¼‰ã€‚
- è®¾ç½®åˆ«åã€ä»£ç†ï¼ˆ`server.proxy`ï¼‰ã€ç¯å¢ƒå˜é‡ã€‚
- é›†æˆ ESLint + Prettier + Huskyï¼ˆå’Œä½ ç°æœ‰æµç¨‹ä¸€è‡´ï¼‰ã€‚

### ç¬¬ä¸‰é˜¶æ®µï¼šé«˜çº§èƒ½åŠ›ï¼ˆå¯é€‰ï¼‰

- è‡ªå®šä¹‰æ’ä»¶ï¼ˆäº†è§£ `enforce`, `transform`, `configureServer`ï¼‰ã€‚
- å¾®å‰ç«¯åœºæ™¯ä¸‹ Vite çš„è¿œç¨‹æ¨¡å—åŠ è½½ï¼ˆä¸ä½  Backstage æ’ä»¶æ–¹å‘ç›¸å…³ï¼‰ã€‚
- ä¸ TSDX / Rollup åº“é¡¹ç›®å¯¹æ¯”ï¼šVite ä¾§é‡åº”ç”¨ï¼ŒTSDX ä¾§é‡ç»„ä»¶åº“ã€‚

---

## ä¸ƒã€æ¨èèµ„æº

- å®˜æ–¹æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰ï¼šhttps://cn.vitejs.dev/
- Vite + React æœ€ä½³å®è·µï¼šhttps://github.com/vitejs/vite/tree/main/packages/create-vite/template-react-ts
- è§†é¢‘æ•™ç¨‹ï¼ˆå°¤é›¨æºªè®²è§£åŸç†ï¼‰ï¼š[Vite 2.0 - The Problems We Faced Building a Next-Gen Frontend Tooling](https://www.youtube.com/watch?v=xXrhg26VCSc)

---

å¦‚æœä½ æœ‰å…·ä½“åœºæ™¯ï¼ˆæ¯”å¦‚â€œå¦‚ä½•åœ¨ Vite ä¸­é›†æˆ Ant Design æŒ‰éœ€åŠ è½½â€æˆ–â€œå¦‚ä½•æ›¿ä»£ Webpack æ„å»º Backstage æ’ä»¶â€ï¼‰ï¼Œæˆ‘å¯ä»¥ç»™å‡ºé’ˆå¯¹æ€§é…ç½®ç¤ºä¾‹ã€‚éœ€è¦å—ï¼Ÿ
