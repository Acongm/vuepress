# æ–‡æ¡£é¡µé¢ AI å†…å®¹æç‚¼åŠŸèƒ½ - å®ç°æ–¹æ¡ˆ

## ğŸ“‹ éœ€æ±‚åˆ†æ

### ç”¨æˆ·éœ€æ±‚
> åœ¨æ¯ä¸ªæ–‡æ¡£å³ä¸‹è§’å¢åŠ  AI å†…å®¹æç‚¼çš„åŠŸèƒ½

### æ ¸å¿ƒé—®é¢˜
> ä¼šä¸ä¼šæš´éœ² AI Tokenï¼Ÿ

## âœ… å¯è¡Œæ€§åˆ†æ

### ç­”æ¡ˆï¼šå¯ä»¥å®ç°ï¼Œä¸”ä¸ä¼šæš´éœ² Token

**åŸå› **ï¼š
1. âœ… ä½¿ç”¨**æœåŠ¡ç«¯ä»£ç†**æ¶æ„
2. âœ… API Key å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯
3. âœ… å‰ç«¯ä»…è°ƒç”¨ä»£ç†æ¥å£
4. âœ… Token æ°¸ä¸å‘é€åˆ°å®¢æˆ·ç«¯

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ–¹æ¡ˆå¯¹æ¯”

#### âŒ æ–¹æ¡ˆ Aï¼šå‰ç«¯ç›´æ¥è°ƒç”¨ï¼ˆä¸å®‰å…¨ï¼‰

```
æµè§ˆå™¨
  â†“ (åŒ…å« API Key)
GLM-4 API
```

**ç¼ºç‚¹**ï¼š
- âŒ API Key æš´éœ²åœ¨å‰ç«¯ä»£ç 
- âŒ ç”¨æˆ·å¯ä»¥ä»æµè§ˆå™¨æ§åˆ¶å°è·å–
- âŒ å¯èƒ½è¢«æ»¥ç”¨
- âŒ **ç»å¯¹ä¸å¯è¡Œ**

#### âœ… æ–¹æ¡ˆ Bï¼šæœåŠ¡ç«¯ä»£ç†ï¼ˆå®‰å…¨ï¼‰

```
æµè§ˆå™¨
  â†“ (ä¸åŒ…å« API Key)
ä»£ç†æœåŠ¡å™¨ (Node.js/Vercel Edge Function)
  â†“ (åŒ…å« API Keyï¼ŒæœåŠ¡ç«¯å­˜å‚¨)
GLM-4 API
```

**ä¼˜ç‚¹**ï¼š
- âœ… API Key å­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯
- âœ… å‰ç«¯æ— æ³•è·å– Token
- âœ… å¯ä»¥æ·»åŠ è¯·æ±‚é™æµ
- âœ… å¯ä»¥è®°å½•å®¡è®¡æ—¥å¿—
- âœ… **æ¨èæ–¹æ¡ˆ**

#### âœ… æ–¹æ¡ˆ Cï¼šæ„å»ºæ—¶ç”Ÿæˆï¼ˆæœ€å®‰å…¨ï¼Œä½†ä¸å®æ—¶ï¼‰

```
æ„å»ºæ—¶
  â†“ (GitHub Actions ä¸­è°ƒç”¨ GLM-4)
ç”Ÿæˆæ‰€æœ‰æ–‡æ¡£çš„æ‘˜è¦
  â†“
å­˜å‚¨ä¸ºé™æ€ JSON æ–‡ä»¶
  â†“
éƒ¨ç½²åˆ°é™æ€ç«™ç‚¹
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨ä¸æš´éœ² Token
- âœ… è®¿é—®é€Ÿåº¦æœ€å¿«
- âœ… æ— è¿è¡Œæ—¶æˆæœ¬

**ç¼ºç‚¹**ï¼š
- âŒ ä¸å®æ—¶ï¼ˆéœ€è¦é‡æ–°æ„å»ºï¼‰
- âŒ å¢åŠ æ„å»ºæ—¶é—´

## ğŸ¯ æ¨èå®ç°æ–¹æ¡ˆ

### æ–¹æ¡ˆé€‰æ‹©ï¼šæ··åˆæ–¹æ¡ˆ

**åŸºç¡€ç‰ˆï¼ˆæ–¹æ¡ˆ Cï¼‰**ï¼šæ„å»ºæ—¶é¢„ç”Ÿæˆ
- å¯¹æ‰€æœ‰ç°æœ‰æ–‡æ¡£ç”Ÿæˆæ‘˜è¦
- å­˜å‚¨ä¸ºé™æ€ JSON
- æ„å»ºæ—¶è‡ªåŠ¨æ›´æ–°

**å¢å¼ºç‰ˆï¼ˆæ–¹æ¡ˆ Bï¼‰**ï¼šå®æ—¶ç”Ÿæˆ
- å¯¹æ–°æ–‡æ¡£æˆ–ç”¨æˆ·è¯·æ±‚å®æ—¶ç”Ÿæˆ
- é€šè¿‡æœåŠ¡ç«¯ä»£ç†è°ƒç”¨
- å¯é€‰åŠŸèƒ½ï¼ˆéœ€è¦éƒ¨ç½²æœåŠ¡ï¼‰

## ğŸ“ å®ç°æ­¥éª¤

### ç¬¬ 1 æ­¥ï¼šæ„å»ºæ—¶é¢„ç”Ÿæˆï¼ˆåŸºç¡€ç‰ˆï¼‰

#### 1.1 åˆ›å»ºæ‘˜è¦ç”Ÿæˆè„šæœ¬

**æ–‡ä»¶**ï¼š`tools/generate-summaries.mjs`

```javascript
#!/usr/bin/env node
/**
 * ä¸ºæ‰€æœ‰æ–‡æ¡£ç”Ÿæˆ AI æ‘˜è¦
 * åœ¨æ„å»ºæ—¶è¿è¡Œï¼Œå­˜å‚¨ä¸ºé™æ€ JSON
 */

import { readFileSync, writeFileSync, readdirSync } from 'node:fs'
import { resolve, join } from 'node:path'

async function generateSummary(content, filePath) {
  // æå–å‰ 1000 å­—ç¬¦
  const excerpt = content.slice(0, 1000)
  
  // è°ƒç”¨ GLM-4 ç”Ÿæˆæ‘˜è¦
  const response = await fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${process.env.GLM_API_KEY}`
    },
    body: JSON.stringify({
      model: 'glm-4-flash',
      messages: [
        {
          role: 'system',
          content: 'ä½ æ˜¯ä¸€ä¸ªæŠ€æœ¯æ–‡æ¡£æ‘˜è¦åŠ©æ‰‹ã€‚è¯·ç”¨ 2-3 å¥è¯æ¦‚æ‹¬æ–‡æ¡£çš„æ ¸å¿ƒå†…å®¹ã€‚'
        },
        {
          role: 'user',
          content: `è¯·æ¦‚æ‹¬ä»¥ä¸‹æ–‡æ¡£çš„æ ¸å¿ƒå†…å®¹ï¼š\n\n${excerpt}`
        }
      ],
      temperature: 0.3,
      max_tokens: 200
    })
  })
  
  const data = await response.json()
  return data.choices[0]?.message?.content || 'æš‚æ— æ‘˜è¦'
}

async function generateAllSummaries() {
  const summaries = {}
  
  // æ‰«ææ‰€æœ‰ Markdown æ–‡ä»¶
  const docsDir = resolve(process.cwd(), 'docs')
  // ... éå†æ–‡ä»¶ç”Ÿæˆæ‘˜è¦
  
  // ä¿å­˜åˆ° JSON æ–‡ä»¶
  writeFileSync(
    resolve(process.cwd(), 'docs/.vuepress/public/summaries.json'),
    JSON.stringify(summaries, null, 2)
  )
}

generateAllSummaries()
```

#### 1.2 åœ¨ GitHub Actions ä¸­è°ƒç”¨

**æ–‡ä»¶**ï¼š`.github/workflows/blank.yml`

```yaml
- name: Install and Build
  run: |
    npm install
    
    # ç”Ÿæˆ AI æ‘˜è¦ï¼ˆä½¿ç”¨ GitHub Secretï¼‰
    node tools/generate-summaries.mjs
    
    npm run build

env:
  GLM_API_KEY: ${{ secrets.GLM_API_KEY }}
```

#### 1.3 å‰ç«¯è¯»å–æ‘˜è¦

```vue
<!-- docs/.vuepress/theme/components/AISummary.vue -->
<template>
  <div class="ai-summary">
    <button @click="showSummary = !showSummary">
      <svg><!-- AI å›¾æ ‡ --></svg>
      AI æç‚¼
    </button>
    
    <div v-if="showSummary" class="summary-panel">
      <h4>å†…å®¹æç‚¼</h4>
      <p>{{ summary }}</p>
      <small>ç”± GLM-4 è‡ªåŠ¨ç”Ÿæˆ</small>
    </div>
  </div>
</template>

<script>
export default {
  data() {
    return {
      showSummary: false,
      summary: ''
    }
  },
  
  async mounted() {
    // è¯»å–é¢„ç”Ÿæˆçš„æ‘˜è¦
    const response = await fetch('/summaries.json')
    const summaries = await response.json()
    this.summary = summaries[this.$page.path] || 'æš‚æ— æ‘˜è¦'
  }
}
</script>
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨ä¸æš´éœ² Token
- âœ… è®¿é—®é€Ÿåº¦å¿«
- âœ… æ— è¿è¡Œæ—¶æˆæœ¬

**ç¼ºç‚¹**ï¼š
- âš ï¸ æ¯æ¬¡æ„å»ºéƒ½è¦è°ƒç”¨ APIï¼ˆå¯ç¼“å­˜å·²ç”Ÿæˆçš„ï¼‰
- âš ï¸ ä¸å®æ—¶

### ç¬¬ 2 æ­¥ï¼šæœåŠ¡ç«¯ä»£ç†ï¼ˆå¢å¼ºç‰ˆï¼‰

#### 2.1 åˆ›å»º Vercel Edge Function

**æ–‡ä»¶**ï¼š`api/summarize.js`

```javascript
// Vercel Edge Function
export const config = {
  runtime: 'edge'
}

export default async function handler(request) {
  // éªŒè¯è¯·æ±‚æ¥æº
  const origin = request.headers.get('origin')
  if (!origin?.includes('acongm.com')) {
    return new Response('Forbidden', { status: 403 })
  }
  
  // é™æµï¼šæ¯ä¸ª IP æ¯åˆ†é’Ÿæœ€å¤š 5 æ¬¡è¯·æ±‚
  // ... å®ç°é™æµé€»è¾‘
  
  const { content } = await request.json()
  
  // è°ƒç”¨ GLM-4ï¼ˆAPI Key å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ï¼‰
  const response = await fetch('https://open.bigmodel.cn/api/paas/v4/chat/completions', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${process.env.GLM_API_KEY}`
    },
    body: JSON.stringify({
      model: 'glm-4-flash',
      messages: [
        {
          role: 'system',
          content: 'ä½ æ˜¯ä¸€ä¸ªæŠ€æœ¯æ–‡æ¡£æ‘˜è¦åŠ©æ‰‹ã€‚'
        },
        {
          role: 'user',
          content: `æ¦‚æ‹¬ï¼š${content.slice(0, 1000)}`
        }
      ],
      temperature: 0.3,
      max_tokens: 200
    })
  })
  
  const data = await response.json()
  
  return new Response(JSON.stringify({
    summary: data.choices[0]?.message?.content
  }), {
    headers: {
      'Content-Type': 'application/json',
      'Access-Control-Allow-Origin': origin
    }
  })
}
```

#### 2.2 å‰ç«¯è°ƒç”¨ä»£ç†

```vue
<script>
export default {
  methods: {
    async generateSummary() {
      this.loading = true
      
      try {
        // è°ƒç”¨ä»£ç†æ¥å£ï¼ˆä¸åŒ…å« API Keyï¼‰
        const response = await fetch('/api/summarize', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            content: this.$page.content
          })
        })
        
        const { summary } = await response.json()
        this.summary = summary
        
        // ç¼“å­˜åˆ° localStorage
        localStorage.setItem(
          `summary:${this.$page.path}`,
          summary
        )
      } catch (error) {
        this.summary = 'ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•'
      } finally {
        this.loading = false
      }
    }
  }
}
</script>
```

**ä¼˜ç‚¹**ï¼š
- âœ… å®æ—¶ç”Ÿæˆ
- âœ… Token å®Œå…¨å®‰å…¨
- âœ… å¯ä»¥æ·»åŠ é™æµ

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦éƒ¨ç½²æœåŠ¡ç«¯
- âš ï¸ æœ‰è¿è¡Œæ—¶æˆæœ¬

### ç¬¬ 3 æ­¥ï¼šåˆ›å»ºå‰ç«¯ç»„ä»¶

#### 3.1 AI æç‚¼æŒ‰é’®ç»„ä»¶

**æ–‡ä»¶**ï¼š`docs/.vuepress/components/AISummaryButton.vue`

```vue
<template>
  <div class="ai-summary-button">
    <Transition name="fade">
      <button 
        v-if="!showPanel"
        class="ai-button"
        @click="togglePanel"
        :title="title"
      >
        <svg class="ai-icon" viewBox="0 0 24 24">
          <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
          <path d="M12 8v8m-4-4h8"/>
        </svg>
        <span>AI æç‚¼</span>
      </button>
    </Transition>
    
    <Transition name="slide">
      <div v-if="showPanel" class="summary-panel">
        <div class="panel-header">
          <h3>
            <svg class="ai-icon-small" viewBox="0 0 24 24">
              <circle cx="12" cy="12" r="10"/>
            </svg>
            AI å†…å®¹æç‚¼
          </h3>
          <button class="close-btn" @click="togglePanel">Ã—</button>
        </div>
        
        <div class="panel-body">
          <div v-if="loading" class="loading">
            <div class="spinner"></div>
            <p>AI æ­£åœ¨åˆ†ææ–‡æ¡£å†…å®¹...</p>
          </div>
          
          <div v-else-if="summary" class="summary-content">
            <p>{{ summary }}</p>
            <div class="meta">
              <span class="badge">GLM-4 ç”Ÿæˆ</span>
              <button @click="regenerate" class="regenerate-btn">
                ğŸ”„ é‡æ–°ç”Ÿæˆ
              </button>
            </div>
          </div>
          
          <div v-else class="error">
            <p>âš ï¸ ç”Ÿæˆå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>
            <button @click="generateSummary">é‡è¯•</button>
          </div>
        </div>
      </div>
    </Transition>
  </div>
</template>

<script>
export default {
  name: 'AISummaryButton',
  
  data() {
    return {
      showPanel: false,
      loading: false,
      summary: '',
      title: 'AI æç‚¼æ–‡æ¡£æ ¸å¿ƒå†…å®¹'
    }
  },
  
  mounted() {
    // æ£€æŸ¥æ˜¯å¦æœ‰ç¼“å­˜
    const cached = this.getCachedSummary()
    if (cached) {
      this.summary = cached
    }
  },
  
  methods: {
    togglePanel() {
      this.showPanel = !this.showPanel
      
      if (this.showPanel && !this.summary && !this.loading) {
        this.generateSummary()
      }
    },
    
    getCachedSummary() {
      const key = `summary:${this.$page.path}`
      return localStorage.getItem(key)
    },
    
    setCachedSummary(summary) {
      const key = `summary:${this.$page.path}`
      localStorage.setItem(key, summary)
    },
    
    async generateSummary() {
      this.loading = true
      this.summary = ''
      
      try {
        // ä¼˜å…ˆä½¿ç”¨é¢„ç”Ÿæˆçš„æ‘˜è¦
        const pregenerated = await this.loadPregeneratedSummary()
        if (pregenerated) {
          this.summary = pregenerated
          this.setCachedSummary(pregenerated)
          return
        }
        
        // å¦‚æœæ²¡æœ‰é¢„ç”Ÿæˆï¼Œè°ƒç”¨å®æ—¶ APIï¼ˆéœ€è¦æœåŠ¡ç«¯ä»£ç†ï¼‰
        const summary = await this.callSummaryAPI()
        this.summary = summary
        this.setCachedSummary(summary)
        
      } catch (error) {
        console.error('ç”Ÿæˆæ‘˜è¦å¤±è´¥:', error)
        this.summary = null
      } finally {
        this.loading = false
      }
    },
    
    async loadPregeneratedSummary() {
      try {
        const response = await fetch('/summaries.json')
        const summaries = await response.json()
        return summaries[this.$page.path]
      } catch {
        return null
      }
    },
    
    async callSummaryAPI() {
      // å¦‚æœæœ‰æœåŠ¡ç«¯ä»£ç†ï¼Œè°ƒç”¨ä»£ç†
      if (this.hasProxyAPI()) {
        const response = await fetch('/api/summarize', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            path: this.$page.path,
            content: this.$page.content?.slice(0, 1000)
          })
        })
        
        const data = await response.json()
        return data.summary
      }
      
      // å¦åˆ™è¿”å›é»˜è®¤æç¤º
      return 'å®æ—¶ç”ŸæˆåŠŸèƒ½éœ€è¦æœåŠ¡ç«¯æ”¯æŒã€‚è¯·ä½¿ç”¨é¢„ç”Ÿæˆæ‘˜è¦æˆ–è”ç³»ç®¡ç†å‘˜å¯ç”¨ã€‚'
    },
    
    hasProxyAPI() {
      // æ£€æŸ¥æ˜¯å¦éƒ¨ç½²äº†ä»£ç† API
      return false // é»˜è®¤å…³é—­ï¼Œéƒ¨ç½²åå¯è®¾ç½®ä¸º true
    },
    
    regenerate() {
      // æ¸…é™¤ç¼“å­˜ï¼Œé‡æ–°ç”Ÿæˆ
      localStorage.removeItem(`summary:${this.$page.path}`)
      this.generateSummary()
    }
  }
}
</script>

<style scoped>
.ai-summary-button {
  position: fixed;
  bottom: 80px;
  right: 24px;
  z-index: 1000;
}

.ai-button {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  border-radius: 24px;
  box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
  cursor: pointer;
  font-size: 14px;
  font-weight: 500;
  transition: all 0.3s ease;
}

.ai-button:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 16px rgba(102, 126, 234, 0.6);
}

.ai-icon {
  width: 20px;
  height: 20px;
  fill: white;
}

.summary-panel {
  position: fixed;
  bottom: 24px;
  right: 24px;
  width: 380px;
  max-height: 500px;
  background: white;
  border-radius: 12px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.panel-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
}

.panel-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.ai-icon-small {
  width: 16px;
  height: 16px;
  fill: white;
}

.close-btn {
  background: none;
  border: none;
  color: white;
  font-size: 24px;
  cursor: pointer;
  padding: 0;
  width: 24px;
  height: 24px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.panel-body {
  padding: 20px;
  overflow-y: auto;
  flex: 1;
}

.loading {
  text-align: center;
  padding: 20px 0;
}

.spinner {
  width: 40px;
  height: 40px;
  margin: 0 auto 12px;
  border: 3px solid #f3f3f3;
  border-top: 3px solid #667eea;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.summary-content {
  line-height: 1.8;
  color: #333;
}

.summary-content p {
  margin: 0 0 16px 0;
}

.meta {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding-top: 16px;
  border-top: 1px solid #eee;
}

.badge {
  display: inline-block;
  padding: 4px 12px;
  background: #f0f0f0;
  border-radius: 12px;
  font-size: 12px;
  color: #666;
}

.regenerate-btn {
  background: none;
  border: 1px solid #ddd;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  color: #666;
  transition: all 0.2s;
}

.regenerate-btn:hover {
  border-color: #667eea;
  color: #667eea;
}

.error {
  text-align: center;
  color: #f56c6c;
}

.fade-enter-active, .fade-leave-active {
  transition: opacity 0.3s;
}

.fade-enter-from, .fade-leave-to {
  opacity: 0;
}

.slide-enter-active, .slide-leave-active {
  transition: all 0.3s ease;
}

.slide-enter-from, .slide-leave-to {
  transform: translateY(20px);
  opacity: 0;
}

@media (max-width: 768px) {
  .summary-panel {
    width: calc(100% - 48px);
    right: 24px;
    left: 24px;
  }
}
</style>
```

#### 3.2 åœ¨å¸ƒå±€ä¸­æ·»åŠ ç»„ä»¶

**æ–‡ä»¶**ï¼š`docs/.vuepress/theme/layouts/Layout.vue`

```vue
<template>
  <ParentLayout>
    <!-- æ·»åŠ  AI æç‚¼æŒ‰é’® -->
    <template #page-bottom>
      <AISummaryButton />
    </template>
  </ParentLayout>
</template>

<script>
import ParentLayout from '@vuepress/theme-default/lib/client/layouts/Layout.vue'
import AISummaryButton from '../components/AISummaryButton.vue'

export default {
  components: {
    ParentLayout,
    AISummaryButton
  }
}
</script>
```

## ğŸ”’ å®‰å…¨ä¿éšœ

### Token ä¿æŠ¤æªæ–½

#### 1. æ„å»ºæ—¶æ–¹æ¡ˆï¼ˆæ¨èï¼‰

```yaml
# .github/workflows/blank.yml
env:
  GLM_API_KEY: ${{ secrets.GLM_API_KEY }}  # ä»… CI å¯è®¿é—®

steps:
  - name: Generate Summaries
    run: node tools/generate-summaries.mjs
    # Token ä»…åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ï¼Œä»ä¸å‘é€åˆ°å®¢æˆ·ç«¯
```

**å®‰å…¨æ€§**ï¼š
- âœ… Token ä»…åœ¨ GitHub Actions ä¸­ä½¿ç”¨
- âœ… ç”Ÿæˆçš„æ‘˜è¦æ˜¯çº¯æ–‡æœ¬ï¼Œä¸å« Token
- âœ… éƒ¨ç½²çš„é™æ€æ–‡ä»¶å®Œå…¨å®‰å…¨

#### 2. æœåŠ¡ç«¯ä»£ç†æ–¹æ¡ˆ

```javascript
// api/summarize.js (Vercel Edge Function)
export default async function handler(request) {
  // 1. éªŒè¯æ¥æº
  const origin = request.headers.get('origin')
  if (!isAllowedOrigin(origin)) {
    return new Response('Forbidden', { status: 403 })
  }
  
  // 2. é™æµ
  const ip = request.headers.get('x-forwarded-for')
  if (!checkRateLimit(ip)) {
    return new Response('Too Many Requests', { status: 429 })
  }
  
  // 3. éªŒè¯è¯·æ±‚å¤§å°
  const { content } = await request.json()
  if (content.length > 5000) {
    return new Response('Payload Too Large', { status: 413 })
  }
  
  // 4. è°ƒç”¨ APIï¼ˆToken å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ï¼‰
  const response = await fetch(GLM_API_URL, {
    headers: {
      'Authorization': `Bearer ${process.env.GLM_API_KEY}`
    },
    // ...
  })
  
  // 5. è¿”å›ç»“æœï¼ˆä¸åŒ…å« Tokenï¼‰
  return new Response(JSON.stringify(result))
}
```

**å®‰å…¨æªæ–½**ï¼š
- âœ… Token å­˜å‚¨åœ¨æœåŠ¡å™¨ç¯å¢ƒå˜é‡
- âœ… æ¥æºéªŒè¯ï¼ˆä»…å…è®¸è‡ªå·±çš„åŸŸåï¼‰
- âœ… è¯·æ±‚é™æµï¼ˆé˜²æ­¢æ»¥ç”¨ï¼‰
- âœ… å†…å®¹é•¿åº¦é™åˆ¶
- âœ… å®¡è®¡æ—¥å¿—

#### 3. å¤šå±‚é˜²æŠ¤

```
ç¬¬ 1 å±‚ï¼šç¯å¢ƒå˜é‡å­˜å‚¨
  â”œâ”€ GitHub Secrets (CI)
  â”œâ”€ Vercel Environment Variables (ç”Ÿäº§)
  â””â”€ .env.local (æœ¬åœ°å¼€å‘)

ç¬¬ 2 å±‚ï¼šè®¿é—®æ§åˆ¶
  â”œâ”€ åŸŸåç™½åå•
  â”œâ”€ IP é™æµ
  â””â”€ è¯·æ±‚éªŒè¯

ç¬¬ 3 å±‚ï¼šæ—¥å¿—å®¡è®¡
  â”œâ”€ è®°å½•æ‰€æœ‰è¯·æ±‚
  â”œâ”€ ç›‘æ§å¼‚å¸¸æ´»åŠ¨
  â””â”€ è‡ªåŠ¨å‘Šè­¦

ç¬¬ 4 å±‚ï¼šæˆæœ¬æ§åˆ¶
  â”œâ”€ æ¯ç”¨æˆ·é™é¢
  â”œâ”€ æ€»ä½“é¢„ç®—é™åˆ¶
  â””â”€ è¶…é¢è‡ªåŠ¨åœç”¨
```

## ğŸ“Š æˆæœ¬ä¼°ç®—

### GLM-4-flash å®šä»·ï¼ˆå‚è€ƒï¼‰

å‡è®¾ï¼š
- æ¯æ¬¡æç‚¼æ¶ˆè€— 1500 tokensï¼ˆ1000 è¾“å…¥ + 500 è¾“å‡ºï¼‰
- ä»·æ ¼ï¼šçº¦ Â¥0.001 / 1000 tokens

**æ„å»ºæ—¶æ–¹æ¡ˆ**ï¼š
- 174 ä¸ªæ–‡æ¡£ Ã— Â¥0.0015 = Â¥0.26 / æ¬¡æ„å»º
- æ¯å‘¨æ„å»º 3 æ¬¡ = Â¥0.78 / å‘¨
- **æœˆæˆæœ¬**ï¼šçº¦ Â¥3-5

**å®æ—¶æ–¹æ¡ˆ**ï¼š
- æ¯ä¸ªé¡µé¢è®¿é—® 1 æ¬¡ = Â¥0.0015
- 1000 æ¬¡è®¿é—® = Â¥1.5
- **æœˆæˆæœ¬**ï¼šæ ¹æ®è®¿é—®é‡ï¼Œçº¦ Â¥10-50

**æ¨è**ï¼šä½¿ç”¨æ„å»ºæ—¶æ–¹æ¡ˆ + æœ¬åœ°ç¼“å­˜ï¼Œæˆæœ¬å¯æ§ã€‚

## ğŸ¯ å®æ–½å»ºè®®

### é˜¶æ®µ 1ï¼šåŸºç¡€ç‰ˆï¼ˆç«‹å³å¯ç”¨ï¼‰

1. åˆ›å»º `tools/generate-summaries.mjs`
2. åœ¨ GitHub Actions ä¸­è°ƒç”¨
3. åˆ›å»ºå‰ç«¯ç»„ä»¶ `AISummaryButton.vue`
4. éƒ¨ç½²æµ‹è¯•

**æ—¶é—´**ï¼š2-3 å°æ—¶
**æˆæœ¬**ï¼šæœˆæˆæœ¬ Â¥3-5
**å®‰å…¨**ï¼šå®Œå…¨å®‰å…¨ï¼ˆToken ä¸æš´éœ²ï¼‰

### é˜¶æ®µ 2ï¼šå¢å¼ºç‰ˆï¼ˆå¯é€‰ï¼‰

1. åˆ›å»º Vercel Edge Function
2. æ·»åŠ é™æµå’ŒéªŒè¯
3. å‰ç«¯æ”¯æŒå®æ—¶ç”Ÿæˆ
4. ç›‘æ§å’Œæ—¥å¿—

**æ—¶é—´**ï¼š1-2 å¤©
**æˆæœ¬**ï¼šæœˆæˆæœ¬ Â¥10-50
**å®‰å…¨**ï¼šå¤šå±‚é˜²æŠ¤

### é˜¶æ®µ 3ï¼šä¼˜åŒ–ï¼ˆæœªæ¥ï¼‰

1. æ™ºèƒ½ç¼“å­˜ç­–ç•¥
2. ç¦»çº¿æ”¯æŒ
3. ä¸ªæ€§åŒ–æç‚¼
4. A/B æµ‹è¯•

## ğŸ“š æ€»ç»“

### é—®é¢˜å›ç­”

**Q: å¯ä»¥åœ¨æ–‡æ¡£å³ä¸‹è§’å¢åŠ  AI å†…å®¹æç‚¼åŠŸèƒ½å—ï¼Ÿ**
âœ… **ç­”**ï¼šå¯ä»¥ï¼æ¨èä½¿ç”¨æ„å»ºæ—¶é¢„ç”Ÿæˆæ–¹æ¡ˆã€‚

**Q: ä¼šä¸ä¼šæš´éœ² AI Tokenï¼Ÿ**
âœ… **ç­”**ï¼šä¸ä¼šï¼Token ä»…åœ¨æœåŠ¡å™¨ç«¯ä½¿ç”¨ï¼Œå‰ç«¯åªè¯»å–ç”Ÿæˆçš„ç»“æœã€‚

### æ¨èæ–¹æ¡ˆ

**æ„å»ºæ—¶é¢„ç”Ÿæˆ** + **å‰ç«¯å±•ç¤º**

**ä¼˜ç‚¹**ï¼š
- âœ… å®Œå…¨å®‰å…¨
- âœ… è®¿é—®å¿«é€Ÿ
- âœ… æˆæœ¬ä½å»‰
- âœ… æ˜“äºå®ç°

**å®æ–½æ­¥éª¤**ï¼š
1. åˆ›å»ºæ‘˜è¦ç”Ÿæˆè„šæœ¬
2. åœ¨ CI ä¸­è°ƒç”¨
3. åˆ›å»ºå‰ç«¯ç»„ä»¶
4. éƒ¨ç½²ä¸Šçº¿

**é¢„è®¡æ—¶é—´**ï¼š2-3 å°æ—¶

---

**ä¸‹ä¸€æ­¥**ï¼šå¼€å§‹å®æ–½åŸºç¡€ç‰ˆæ–¹æ¡ˆï¼
